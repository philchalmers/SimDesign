<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>One Dimensional Root (Zero) Finding in Simulation Experiments — SimSolve • SimDesign</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="One Dimensional Root (Zero) Finding in Simulation Experiments — SimSolve"><meta name="description" content="Function provides a stochastic root-finding approach to solve
specific quantities in simulation experiments (e.g., solving for a specific
sample size to meet a target power rate) using the
Probablistic Bisection Algorithm with Bolstering and Interpolations
(ProBABLI; Chalmers, 2024). The structure follows the
three functional steps outlined in runSimulation, however portions of
the design input are taken as variables to be estimated rather than
fixed, where an additional constant b is required in order to
solve the root equation f(x) - b = 0."><meta property="og:description" content="Function provides a stochastic root-finding approach to solve
specific quantities in simulation experiments (e.g., solving for a specific
sample size to meet a target power rate) using the
Probablistic Bisection Algorithm with Bolstering and Interpolations
(ProBABLI; Chalmers, 2024). The structure follows the
three functional steps outlined in runSimulation, however portions of
the design input are taken as variables to be estimated rather than
fixed, where an additional constant b is required in order to
solve the root equation f(x) - b = 0."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SimDesign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.19.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Catch_errors.html">Managing warning and error messages</a></li>
    <li><a class="dropdown-item" href="../articles/Fixed_obj_fun.html">Exporting objects and functions from the workspace</a></li>
    <li><a class="dropdown-item" href="../articles/HPC-computing.html">Distributing jobs for high-performance computing (HPC) clusters (e.g., via Slurm)</a></li>
    <li><a class="dropdown-item" href="../articles/MultipleAnalyses.html">Multiple analysis functions</a></li>
    <li><a class="dropdown-item" href="../articles/Parallel-computing.html">Parallel computing information</a></li>
    <li><a class="dropdown-item" href="../articles/Saving-results.html">Saving simulation results and state</a></li>
    <li><a class="dropdown-item" href="../articles/SimDesign-intro.html">Introduction to the SimDesign package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/SimDesign/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>One Dimensional Root (Zero) Finding in Simulation Experiments</h1>
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/SimDesign/blob/main/R/SimSolve.R" class="external-link"><code>R/SimSolve.R</code></a></small>
      <div class="d-none name"><code>SimSolve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function provides a stochastic root-finding approach to solve
specific quantities in simulation experiments (e.g., solving for a specific
sample size to meet a target power rate) using the
Probablistic Bisection Algorithm with Bolstering and Interpolations
(ProBABLI; Chalmers, 2024). The structure follows the
three functional steps outlined in <code><a href="runSimulation.html">runSimulation</a></code>, however portions of
the <code>design</code> input are taken as variables to be estimated rather than
fixed, where an additional constant <code>b</code> is required in order to
solve the root equation <code>f(x) - b = 0</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SimSolve</span><span class="op">(</span></span>
<span>  <span class="va">design</span>,</span>
<span>  <span class="va">interval</span>,</span>
<span>  <span class="va">b</span>,</span>
<span>  <span class="va">generate</span>,</span>
<span>  <span class="va">analyse</span>,</span>
<span>  <span class="va">summarise</span>,</span>
<span>  replications <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>burnin.iter <span class="op">=</span> <span class="fl">15L</span>, burnin.reps <span class="op">=</span> <span class="fl">50L</span>, max.reps <span class="op">=</span> <span class="fl">500L</span>,</span>
<span>    min.total.reps <span class="op">=</span> <span class="fl">9000L</span>, increase.by <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span>,</span>
<span>  integer <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  resume <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"ProBABLI"</span>,</span>
<span>  wait.time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fu">parallelly</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html" class="external-link">availableCores</a></span><span class="op">(</span>omit <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"windows"</span>, <span class="st">"PSOCK"</span>, <span class="st">"FORK"</span><span class="op">)</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  check.interval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  predCI <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  predCI.tol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'SimSolve'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, tab.only <span class="op">=</span> <span class="cn">FALSE</span>, reps.cutoff <span class="op">=</span> <span class="fl">300</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'SimSolve'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a></dt>
<dd><p>a <code>tibble</code> or <code>data.frame</code> object containing
the Monte Carlo simulation conditions to be studied, where each row
represents a unique condition and each column a factor to be varied
(see <code><a href="createDesign.html">createDesign</a></code>). However, exactly one column of this
object in each row must be specified with <code>NA</code> placeholders to indicate
that the missing value should be estimated via the select
stochastic optimizer</p></dd>


<dt id="arg-interval">interval<a class="anchor" aria-label="anchor" href="#arg-interval"></a></dt>
<dd><p>a <code>vector</code> of length two, or <code>matrix</code> with
<code>nrow(design)</code> rows and two columns, containing the end-points
of the interval to be searched per row condition.
If a vector then the interval will be used for all rows in the supplied
<code>design</code> object</p></dd>


<dt id="arg-b">b<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>a single constant used to solve the root equation <code>f(x) - b = 0</code></p></dd>


<dt id="arg-generate">generate<a class="anchor" aria-label="anchor" href="#arg-generate"></a></dt>
<dd><p>generate function. See <code><a href="runSimulation.html">runSimulation</a></code></p></dd>


<dt id="arg-analyse">analyse<a class="anchor" aria-label="anchor" href="#arg-analyse"></a></dt>
<dd><p>analysis function. See <code><a href="runSimulation.html">runSimulation</a></code></p></dd>


<dt id="arg-summarise">summarise<a class="anchor" aria-label="anchor" href="#arg-summarise"></a></dt>
<dd><p>summary function that returns a single number corresponding
to the function evaluation <code>f(x)</code> in the equation
<code>f(x) = b</code> to be solved as a root <code>f(x) - b = 0</code>.
Unlike in the standard <code><a href="runSimulation.html">runSimulation()</a></code> definitions this input
is required. For further information on this function specification,
see <code><a href="runSimulation.html">runSimulation</a></code></p></dd>


<dt id="arg-replications">replications<a class="anchor" aria-label="anchor" href="#arg-replications"></a></dt>
<dd><p>a named <code>list</code> or <code>vector</code>
  indicating the number of replication to
  use for each design condition per PBA iteration. By default the input is a
  <code>list</code> with the arguments <code>burnin.iter = 15L</code>, specifying the number
  of burn-in iterations to used, <code>burnin.reps = 50L</code> to indicate how many
  replications to use in each burn-in iteration, <code>max.reps = 500L</code> to
  prevent the replications from increasing higher than this number,
  <code>min.total.reps = 9000L</code> to avoid termination when very few replications
  have been explored (lower bound of the replication budget),
  and <code>increase.by = 10L</code> to indicate how many replications to increase
  per iteration after the burn-in stage. Default can overwritten by explicit definition (e.g.,
  <code>replications = list(increase.by = 25L)</code>).</p>
<p>Vector inputs can specify the exact replications  for each respective
  iteration. As a general rule, early iterations
  should be relatively low for initial searches to avoid unnecessary computations
  when locating the approximate location of the root,
  while the number of replications should gradually increase after this burn-in
  to reduce the sampling variability.</p></dd>


<dt id="arg-integer">integer<a class="anchor" aria-label="anchor" href="#arg-integer"></a></dt>
<dd><p>logical; should the values of the root be considered integer
or numeric? If <code>TRUE</code> then bolstered directional decisions will be
made in the <code><a href="PBA.html">PBA</a></code> function based on the collected sampling history</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>regression formula to use when <code>interpolate = TRUE</code>. Default
fits an orthogonal polynomial of degree 2</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p><code>family</code> argument passed to <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code>. By default
  the <code>'binomial'</code> family is used, as this function defaults to power
  analysis setups where isolated results passed to <code>summarise</code> will
  return 0/1s, however other families should be used if <code>summarise</code>
  returns something else (e.g., if solving for a particular standard error
  then a <code>'gaussian'</code> family would be more appropriate).</p>
<p>Note that if individual results from the <code>analyse</code> steps should
  not be used (i.e., only the aggregate from <code>summarise</code> is meaningful)
  then set <code>control = list(summarise.reg_data = TRUE)</code> to override the default
  behaviour, thereby using only the aggregate information and weights</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>for parallel computing for slower simulation experiments
(see <code><a href="runSimulation.html">runSimulation</a></code> for details)</p></dd>


<dt id="arg-cl">cl<a class="anchor" aria-label="anchor" href="#arg-cl"></a></dt>
<dd><p>see <code><a href="runSimulation.html">runSimulation</a></code></p></dd>


<dt id="arg-save">save<a class="anchor" aria-label="anchor" href="#arg-save"></a></dt>
<dd><p>logical; store temporary file in case of crashes. If detected
in the working directory will automatically be loaded to resume (see
<code><a href="runSimulation.html">runSimulation</a></code> for similar behaviour)</p></dd>


<dt id="arg-resume">resume<a class="anchor" aria-label="anchor" href="#arg-resume"></a></dt>
<dd><p>logical; if a temporary <code>SimDesign</code> file is detected should
the simulation resume from this location? Keeping this <code>TRUE</code> is generally
recommended, however this should be disabled
if using <code>SimSolve</code> within <code><a href="runSimulation.html">runSimulation</a></code> to avoid
reading improper save states</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>optimizer method to use. Default is the stochastic root-finder
<code>'ProBABLI'</code>, but can also be the deterministic options <code>'Brent'</code>
(which uses the function <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code>) or <code>'bisection'</code>
for the classical bisection method. If using deterministic root-finders then
<code>replications</code> must either equal a single constant to reflect
the number of replication to use per deterministic iteration or be a
vector of length <code>maxiter</code> to indicate the replications to use per
iteration</p></dd>


<dt id="arg-wait-time">wait.time<a class="anchor" aria-label="anchor" href="#arg-wait-time"></a></dt>
<dd><p>(optional) argument passed to <code><a href="PBA.html">PBA</a></code> to indicate
the time to wait (specified in minutes if a numeric vector is passed)
per row in the <code>Design</code> object
rather than using pre-determined termination criteria based on the estimates.
For example, if three three conditions were defined in
<code>Design</code>, and <code>wait.time="5"</code>,
then the total search time till terminate after 15 minutes regardless of
independently specified termination criteria in <code>control</code>. See
<code><a href="timeFormater.html">timeFormater</a></code> for alternative specifications</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>see <code><a href="runSimulation.html">runSimulation</a></code></p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>type of cluster (see <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></code>)
  or plotting type to use.</p>
<p>If <code>type</code> used in <code>plot</code>
  then can be <code>'density'</code> to plot the density of the iteration history
  after the burn-in stage, <code>'iterations'</code> for a bubble plot with inverse
  replication weights. If not specified then the default PBA
  plots are provided (see <code><a href="PBA.html">PBA</a></code>)</p></dd>


<dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>the maximum number of iterations (default 100) except when
<code>wait.time</code> is specified (automatically increased to 3000
to avoid early termination)</p></dd>


<dt id="arg-check-interval">check.interval<a class="anchor" aria-label="anchor" href="#arg-check-interval"></a></dt>
<dd><p>logical; should an initial check be made to determine
whether <code>f(interval[1L])</code> and <code>f(interval[2L])</code> have opposite
signs? If <code>FALSE</code>, the specified <code>interval</code> is assumed to contain a root,
where <code>f(interval[1]) &lt; 0</code> and <code>f(interval[2] &gt; 0</code>. Default is <code>TRUE</code></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical; print information to the console?</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>a <code>list</code> of the algorithm control parameters. If not specified,
  the defaults described below are used.</p>
<dl><dt><code>tol</code></dt>
<dd><p>tolerance criteria for early termination (.1 for
     <code>integer = TRUE</code> searches; .00025 for non-integer searches</p></dd>

   <dt><code>rel.tol</code></dt>
<dd><p>relative tolerance criteria for early termination (default .0001)</p></dd>

   <dt><code>k.success</code></dt>
<dd><p>number of consecutive tolerance successes given <code>rel.tol</code> and
     <code>tol</code> criteria (default is 3)</p></dd>

   <dt><code>bolster</code></dt>
<dd><p>logical; should the PBA evaluations use bolstering based on previous
     evaluations? Default is <code>TRUE</code>, though only applicable when <code>integer = TRUE</code></p></dd>

   <dt><code>interpolate.R</code></dt>
<dd><p>number of replications to collect prior to performing
     the interpolation step (default is 3000 after accounting for data exclusion
     from <code>burnin.iter</code>). Setting this to 0 will disable any
     interpolation computations</p></dd>

   <dt><code>include_reps</code></dt>
<dd><p>logical; include a column in the <code>condition</code>
     elements to indicate how many replications are currently being evaluated? Mainly
     useful when further tuning within each ProBABLI iteration is
     desirable (e.g., for increasing/decreasing bootstrap draws as the search progresses).
     Default is <code>FALSE</code></p></dd>

   <dt><code>summarise.reg_data</code></dt>
<dd><p>logical; should the aggregate results from <code>Summarise</code>
     (along with its associated weights) be used for the interpolation steps, or the
     raw data from the <code>Analyse</code> step? Set this to <code>TRUE</code> when the individual
     results from <code>Analyse</code> give less meaningful information</p></dd>


</dl></dd>


<dt id="arg-predci">predCI<a class="anchor" aria-label="anchor" href="#arg-predci"></a></dt>
<dd><p>advertised confidence interval probability for final
model-based prediction of target <code>b</code> given the root input estimate.
Returned as an element in the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> list output</p></dd>


<dt id="arg-predci-tol">predCI.tol<a class="anchor" aria-label="anchor" href="#arg-predci-tol"></a></dt>
<dd><p>(optional) rather than relying on the changes between successive
estimates (default), if the predicting CI is consistently within this
supplied tolerance range then the search will be terminated.
This provides termination behaviour based on the predicted
precision of the root solutions rather than their stability history, and therefore
can be used to obtain estimates with a particular level of advertised accuracy.
For example, when solving for a sample size value (<code>N</code>) if the solution
associated with  <code>b = .80</code> requires that the advertised 95<!-- % prediction CI -->
is consistently between [.795, .805] then <code>predCI.tol = .01</code> should be
used to reflect this tolerance range</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to be pasted to <code><a href="PBA.html">PBA</a></code></p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>object of class <code>'SimSolve'</code></p></dd>


<dt id="arg-tab-only">tab.only<a class="anchor" aria-label="anchor" href="#arg-tab-only"></a></dt>
<dd><p>logical; print only the (reduced) table of estimates?</p></dd>


<dt id="arg-reps-cutoff">reps.cutoff<a class="anchor" aria-label="anchor" href="#arg-reps-cutoff"></a></dt>
<dd><p>integer indicating the rows to omit from the output
if the number of replications are less than this value</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>object of class <code>'SimSolve'</code></p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>design row to plot. If omitted defaults to 1</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>the filled-in <code>design</code> object containing the associated lower and upper interval
  estimates from the stochastic optimization</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Root finding is performed using a progressively bolstered version of the
probabilistic bisection algorithm (<code><a href="PBA.html">PBA</a></code>) to find the
associated root given the noisy simulation
objective function evaluations. Information is collected throughout
the search to make more accurate predictions about the
associated root via interpolation. If interpolations fail, then the last
iteration of the PBA search is returned as the best guess.</p>
<p>For greater advertised accuracy with ProBABLI, termination criteria
can be based on the width of the advertised predicting interval
(via <code>predCI.tol</code>) or by specifying how long the investigator
is willing to wait for the final estimates (via <code>wait.time</code>,
where longer wait times lead to progressively better accuracy in
the final estimates).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chalmers, R. P. (2024). Solving Variables with Monte Carlo Simulation Experiments: A
Stochastic Root-Solving Approach. <code>Psychological Methods</code>. DOI: 10.1037/met0000689</p>
<p>Chalmers, R. P., &amp; Adkins, M. C. (2020). Writing Effective and Reliable Monte Carlo Simulations
with the SimDesign Package. <code>The Quantitative Methods for Psychology, 16</code>(4), 248-280.
<a href="https://doi.org/10.20982/tqmp.16.4.p248" class="external-link">doi:10.20982/tqmp.16.4.p248</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="SFA.html">SFA</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##########################</span></span></span>
<span class="r-in"><span><span class="co">## A Priori Power Analysis</span></span></span>
<span class="r-in"><span><span class="co">##########################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># GOAL: Find specific sample size in each group for independent t-test</span></span></span>
<span class="r-in"><span><span class="co"># corresponding to a power rate of .8</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># For ease of the setup, assume the groups are the same size, and the mean</span></span></span>
<span class="r-in"><span><span class="co"># difference corresponds to Cohen's d values of .2, .5, and .8</span></span></span>
<span class="r-in"><span><span class="co"># This example can be solved numerically using the pwr package (see below),</span></span></span>
<span class="r-in"><span><span class="co"># though the following simulation setup is far more general and can be</span></span></span>
<span class="r-in"><span><span class="co"># used for any generate-analyse combination of interest</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SimFunctions(SimSolve=TRUE)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Step 1 --- Define your conditions under study and create design data.frame.</span></span></span>
<span class="r-in"><span><span class="co">#### However, use NA placeholder for sample size as it must be solved,</span></span></span>
<span class="r-in"><span><span class="co">#### and add desired power rate to object</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Design</span> <span class="op">&lt;-</span> <span class="fu"><a href="createDesign.html">createDesign</a></span><span class="op">(</span>N <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>                       d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.5</span>, <span class="fl">.8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       sig.level <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Design</span>    <span class="co"># solve for NA's</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~</span></span></span>
<span class="r-in"><span><span class="co">#### Step 2 --- Define generate, analyse, and summarise functions</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Generate</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="Attach.html">Attach</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">group1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">group2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">N</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'G1'</span>, <span class="st">'G2'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">dat</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Analyse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">dat</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">DV</span> <span class="op">~</span> <span class="va">group</span>, <span class="va">dat</span>, var.equal<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></span>
<span class="r-in"><span>    <span class="va">p</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Summarise</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">results</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># Must return a single number corresponding to f(x) in the</span></span></span>
<span class="r-in"><span>    <span class="co"># root equation f(x) = b</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fu"><a href="EDR.html">EDR</a></span><span class="op">(</span><span class="va">results</span>, alpha <span class="op">=</span> <span class="va">condition</span><span class="op">$</span><span class="va">sig.level</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">ret</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~</span></span></span>
<span class="r-in"><span><span class="co">#### Step 3 --- Optimize N over the rows in design</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### (For debugging) may want to see if simulation code works as intended first</span></span></span>
<span class="r-in"><span><span class="co">### for some given set of inputs</span></span></span>
<span class="r-in"><span><span class="co"># runSimulation(design=createDesign(N=100, d=.8, sig.level=.05),</span></span></span>
<span class="r-in"><span><span class="co">#              replications=10, generate=Generate, analyse=Analyse,</span></span></span>
<span class="r-in"><span><span class="co">#              summarise=Summarise)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Initial search between N = [10,500] for each row using the default</span></span></span>
<span class="r-in"><span>   <span class="co"># integer solver (integer = TRUE). In this example, b = target power</span></span></span>
<span class="r-in"><span><span class="va">solved</span> <span class="op">&lt;-</span> <span class="fu">SimSolve</span><span class="op">(</span>design<span class="op">=</span><span class="va">Design</span>, b<span class="op">=</span><span class="fl">.8</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">500</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                generate<span class="op">=</span><span class="va">Generate</span>, analyse<span class="op">=</span><span class="va">Analyse</span>,</span></span>
<span class="r-in"><span>                summarise<span class="op">=</span><span class="va">Summarise</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">solved</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">solved</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># also can plot median history and estimate precision</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'history'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'density'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'iterations'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># verify with true power from pwr package</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr" class="external-link">pwr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.2</span>, power <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span> <span class="co"># sig.level/alpha = .05 by default</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.5</span>, power <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.8</span>, power <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use estimated N results to see how close power was</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="va">solved</span><span class="op">$</span><span class="va">N</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.2</span>, n<span class="op">=</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.5</span>, n<span class="op">=</span><span class="va">N</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.8</span>, n<span class="op">=</span><span class="va">N</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># with rounding</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">solved</span><span class="op">$</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.2</span>, n<span class="op">=</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.5</span>, n<span class="op">=</span><span class="va">N</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.8</span>, n<span class="op">=</span><span class="va">N</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### failing analytic formula, confirm results with more precise</span></span></span>
<span class="r-in"><span><span class="co">###  simulation via runSimulation()</span></span></span>
<span class="r-in"><span><span class="co">###  (not required, if accuracy is important then ProBABLI should be run longer)</span></span></span>
<span class="r-in"><span><span class="co"># csolved &lt;- solved</span></span></span>
<span class="r-in"><span><span class="co"># csolved$N &lt;- ceiling(solved$N)</span></span></span>
<span class="r-in"><span><span class="co"># confirm &lt;- runSimulation(design=csolved, replications=10000, parallel=TRUE,</span></span></span>
<span class="r-in"><span><span class="co">#                         generate=Generate, analyse=Analyse,</span></span></span>
<span class="r-in"><span><span class="co">#                         summarise=Summarise)</span></span></span>
<span class="r-in"><span><span class="co"># confirm</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Similarly, terminate if the prediction interval is consistently predicted</span></span></span>
<span class="r-in"><span><span class="co">#   to be between [.795, .805]. Note that maxiter increased as well</span></span></span>
<span class="r-in"><span><span class="va">solved_predCI</span> <span class="op">&lt;-</span> <span class="fu">SimSolve</span><span class="op">(</span>design<span class="op">=</span><span class="va">Design</span>, b<span class="op">=</span><span class="fl">.8</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">500</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     generate<span class="op">=</span><span class="va">Generate</span>, analyse<span class="op">=</span><span class="va">Analyse</span>, summarise<span class="op">=</span><span class="va">Summarise</span>,</span></span>
<span class="r-in"><span>                     maxiter<span class="op">=</span><span class="fl">200</span>, predCI.tol<span class="op">=</span><span class="fl">.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">solved_predCI</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">solved_predCI</span><span class="op">)</span> <span class="co"># note that predCI.b are all within [.795, .805]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="va">solved_predCI</span><span class="op">$</span><span class="va">N</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.2</span>, n<span class="op">=</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.5</span>, n<span class="op">=</span><span class="va">N</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.8</span>, n<span class="op">=</span><span class="va">N</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternatively, and often more realistically, wait.time can be used</span></span></span>
<span class="r-in"><span><span class="co"># to specify how long the user is willing to wait for a final estimate.</span></span></span>
<span class="r-in"><span><span class="co"># Solutions involving more iterations will be more accurate,</span></span></span>
<span class="r-in"><span><span class="co"># and therefore it is recommended to run the ProBABLI root-solver as long</span></span></span>
<span class="r-in"><span><span class="co"># the analyst can tolerate if the most accurate estimates are desired.</span></span></span>
<span class="r-in"><span><span class="co"># Below executes the simulation for 2 minutes per condition</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">solved_2min</span> <span class="op">&lt;-</span> <span class="fu">SimSolve</span><span class="op">(</span>design<span class="op">=</span><span class="va">Design</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, b<span class="op">=</span><span class="fl">.8</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">500</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                generate<span class="op">=</span><span class="va">Generate</span>, analyse<span class="op">=</span><span class="va">Analyse</span>, summarise<span class="op">=</span><span class="va">Summarise</span>,</span></span>
<span class="r-in"><span>                wait.time<span class="op">=</span><span class="st">"2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">solved_2min</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">solved_2min</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use estimated N results to see how close power was</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="va">solved_2min</span><span class="op">$</span><span class="va">N</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>d<span class="op">=</span><span class="fl">.2</span>, n<span class="op">=</span><span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#######################</span></span></span>
<span class="r-in"><span><span class="co">## Sensitivity Analysis</span></span></span>
<span class="r-in"><span><span class="co">#######################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># GOAL: solve effect size d given sample size and power inputs (inputs</span></span></span>
<span class="r-in"><span><span class="co"># for root no longer required to be an integer)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate-Analyse-Summarise functions identical to above, however</span></span></span>
<span class="r-in"><span><span class="co"># Design input includes NA for d element</span></span></span>
<span class="r-in"><span><span class="va">Design</span> <span class="op">&lt;-</span> <span class="fu"><a href="createDesign.html">createDesign</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">50</span>, <span class="fl">25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       d <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>                       sig.level <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Design</span>    <span class="co"># solve for NA's</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~</span></span></span>
<span class="r-in"><span><span class="co">#### Step 2 --- Define generate, analyse, and summarise functions (same as above)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~</span></span></span>
<span class="r-in"><span><span class="co">#### Step 3 --- Optimize d over the rows in design</span></span></span>
<span class="r-in"><span><span class="co"># search between d = [.1, 2] for each row</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In this example, b = target power</span></span></span>
<span class="r-in"><span><span class="co"># note that integer = FALSE to allow smooth updates of d</span></span></span>
<span class="r-in"><span><span class="va">solved</span> <span class="op">&lt;-</span> <span class="fu">SimSolve</span><span class="op">(</span>design<span class="op">=</span><span class="va">Design</span>, b <span class="op">=</span> <span class="fl">.8</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   generate<span class="op">=</span><span class="va">Generate</span>, analyse<span class="op">=</span><span class="va">Analyse</span>,</span></span>
<span class="r-in"><span>                   summarise<span class="op">=</span><span class="va">Summarise</span>, integer<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">solved</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">solved</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot median history and estimate precision</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'history'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'density'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'iterations'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># verify with true power from pwr package</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr" class="external-link">pwr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, power <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, power <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n<span class="op">=</span><span class="fl">25</span>, power <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use estimated d results to see how close power was</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, d <span class="op">=</span> <span class="va">solved</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, d <span class="op">=</span> <span class="va">solved</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n<span class="op">=</span><span class="fl">25</span>, d <span class="op">=</span> <span class="va">solved</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### failing analytic formula, confirm results with more precise</span></span></span>
<span class="r-in"><span><span class="co">###  simulation via runSimulation() (not required; if accuracy is important</span></span></span>
<span class="r-in"><span><span class="co">###  PROBABLI should just be run longer)</span></span></span>
<span class="r-in"><span><span class="co"># confirm &lt;- runSimulation(design=solved, replications=10000, parallel=TRUE,</span></span></span>
<span class="r-in"><span><span class="co">#                         generate=Generate, analyse=Analyse,</span></span></span>
<span class="r-in"><span><span class="co">#                         summarise=Summarise)</span></span></span>
<span class="r-in"><span><span class="co"># confirm</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####################</span></span></span>
<span class="r-in"><span><span class="co">## Criterion Analysis</span></span></span>
<span class="r-in"><span><span class="co">#####################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># GOAL: solve Type I error rate (alpha) given sample size, effect size, and</span></span></span>
<span class="r-in"><span><span class="co"># power inputs (inputs for root no longer required to be an integer). Only useful</span></span></span>
<span class="r-in"><span><span class="co"># when Type I error is less important than achieving the desired 1-beta (power)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Design</span> <span class="op">&lt;-</span> <span class="fu"><a href="createDesign.html">createDesign</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>                        d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.5</span>, <span class="fl">.8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        sig.level <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Design</span>    <span class="co"># solve for NA's</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># all other function definitions same as above</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># search for alpha within [.0001, .8]</span></span></span>
<span class="r-in"><span><span class="va">solved</span> <span class="op">&lt;-</span> <span class="fu">SimSolve</span><span class="op">(</span>design<span class="op">=</span><span class="va">Design</span>, b <span class="op">=</span> <span class="fl">.8</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.0001</span>, <span class="fl">.8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   generate<span class="op">=</span><span class="va">Generate</span>, analyse<span class="op">=</span><span class="va">Analyse</span>,</span></span>
<span class="r-in"><span>                   summarise<span class="op">=</span><span class="va">Summarise</span>, integer<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">solved</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">solved</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot median history and estimate precision</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'history'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'density'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">solved</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'iterations'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># verify with true power from pwr package</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr" class="external-link">pwr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, power <span class="op">=</span> <span class="fl">.8</span>, d <span class="op">=</span> <span class="fl">.2</span>, sig.level<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, power <span class="op">=</span> <span class="fl">.8</span>, d <span class="op">=</span> <span class="fl">.5</span>, sig.level<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, power <span class="op">=</span> <span class="fl">.8</span>, d <span class="op">=</span> <span class="fl">.8</span>, sig.level<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use estimated alpha results to see how close power was</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, d <span class="op">=</span> <span class="fl">.2</span>, sig.level<span class="op">=</span><span class="va">solved</span><span class="op">$</span><span class="va">sig.level</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, d <span class="op">=</span> <span class="fl">.5</span>, sig.level<span class="op">=</span><span class="va">solved</span><span class="op">$</span><span class="va">sig.level</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr.t.test</span><span class="op">(</span>n<span class="op">=</span><span class="fl">50</span>, d <span class="op">=</span> <span class="fl">.8</span>, sig.level<span class="op">=</span><span class="va">solved</span><span class="op">$</span><span class="va">sig.level</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### failing analytic formula, confirm results with more precise</span></span></span>
<span class="r-in"><span><span class="co">###  simulation via runSimulation() (not required; if accuracy is important</span></span></span>
<span class="r-in"><span><span class="co">###  PROBABLI should just be run longer)</span></span></span>
<span class="r-in"><span><span class="co"># confirm &lt;- runSimulation(design=solved, replications=10000, parallel=TRUE,</span></span></span>
<span class="r-in"><span><span class="co">#                         generate=Generate, analyse=Analyse,</span></span></span>
<span class="r-in"><span><span class="co">#                         summarise=Summarise)</span></span></span>
<span class="r-in"><span><span class="co"># confirm</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

