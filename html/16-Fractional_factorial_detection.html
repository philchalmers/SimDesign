<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Phil Chalmers">

<title>Fully-crossed simulation designs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="16-Fractional_factorial_detection_files/libs/clipboard/clipboard.min.js"></script>
<script src="16-Fractional_factorial_detection_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="16-Fractional_factorial_detection_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="16-Fractional_factorial_detection_files/libs/quarto-html/popper.min.js"></script>
<script src="16-Fractional_factorial_detection_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="16-Fractional_factorial_detection_files/libs/quarto-html/anchor.min.js"></script>
<link href="16-Fractional_factorial_detection_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="16-Fractional_factorial_detection_files/libs/quarto-html/quarto-syntax-highlighting-fe31d7bd2deb2a321418d01dba375a64.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="16-Fractional_factorial_detection_files/libs/quarto-html/quarto-syntax-highlighting-dark-f22e6b1ee40b1f8b08691e31e3ed3812.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="16-Fractional_factorial_detection_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="16-Fractional_factorial_detection_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="16-Fractional_factorial_detection_files/libs/bootstrap/bootstrap-9da755a953bcc7a1da2a0997e2be6de7.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="16-Fractional_factorial_detection_files/libs/bootstrap/bootstrap-dark-97673b6a6603f454becd47ddaaa96e03.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-dark"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    window.setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      window.setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    window.hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(darkModeDefault) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const darkModeDefault = true;
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !window.hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
    };
    // Switch to dark mode if need be
    if (window.hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#fully-crossed-design-example" id="toc-fully-crossed-design-example" class="nav-link active" data-scroll-target="#fully-crossed-design-example">Fully-crossed design example</a></li>
  <li><a href="#fractional-factorial-experiments" id="toc-fractional-factorial-experiments" class="nav-link" data-scroll-target="#fractional-factorial-experiments">Fractional factorial experiments</a>
  <ul class="collapse">
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Fully-crossed simulation designs</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Phil Chalmers </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>In situations where researchers are unaware which variables or combinations of variables influence a given outcome, and when computing the relevant models is very expensive, Monte Carlo simulations can be used. In this case computer-driven experimental designs can be constructed with the goal of detecting (or screening) which factors affect a given outcome variable through statistical inference. Montgomery (2017) describes this class of screening experiments as “… tests in which many factors are considered and the objective is to identify those factors that have significant effects”, which are typically relevant in early stages of a given project.</p>
<p>The most common designs implemented (and indeed, the default used by ) are those which fully-cross the factor variables, leading to a set of <span class="math inline">\(C_1\times C_2 \times \cdots \times C_n\)</span> unique conditions to study. Fully-crossed designs are beneficial when detecting main effects, two-way interactions, and up to <span class="math inline">\(n\)</span>-way interactions (provided that the number of replications per unique condition is greater than 1).</p>
<p>For example, consider the following fully-crossed experimental design that combines five simulation factors in the context of an independent samples <span class="math inline">\(t\)</span>-test’s ability to detect true mean differences: sample size, the magnitude of the mean difference, group variances, distributions, whether the group sizes were equal or unequal, if the distributions were symmetric/asymmetric.</p>
<section id="fully-crossed-design-example" class="level2">
<h2 class="anchored" data-anchor-id="fully-crossed-design-example">Fully-crossed design example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SimDesign)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Design <span class="ot">&lt;-</span> <span class="fu">createDesign</span>(<span class="at">sample_size=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">200</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mean_diff=</span><span class="fu">c</span>(.<span class="dv">25</span>, <span class="dv">2</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">variance.ratio=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">equal_size=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">dists=</span><span class="fu">c</span>(<span class="st">'norm'</span>, <span class="st">'skew'</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">same_dists=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">symmetric=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># remove same-normal combo</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">subset =</span> <span class="sc">!</span>(symmetric <span class="sc">&amp;</span> dists <span class="sc">==</span> <span class="st">'norm'</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>Design</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 96 × 7
   sample_size mean_diff variance.ratio equal_size dists same_dists symmetric
         &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;lgl&gt;      &lt;chr&gt; &lt;lgl&gt;      &lt;lgl&gt;    
 1         100      0.25              1 TRUE       skew  TRUE       TRUE     
 2         200      0.25              1 TRUE       skew  TRUE       TRUE     
 3         100      2                 1 TRUE       skew  TRUE       TRUE     
 4         200      2                 1 TRUE       skew  TRUE       TRUE     
 5         100      0.25              4 TRUE       skew  TRUE       TRUE     
 6         200      0.25              4 TRUE       skew  TRUE       TRUE     
 7         100      2                 4 TRUE       skew  TRUE       TRUE     
 8         200      2                 4 TRUE       skew  TRUE       TRUE     
 9         100      0.25              1 FALSE      skew  TRUE       TRUE     
10         200      0.25              1 FALSE      skew  TRUE       TRUE     
# ℹ 86 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Design)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 96  7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>Generate <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, <span class="at">fixed_objects =</span> <span class="cn">NULL</span>) {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Attach</span>(condition)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    N1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(equal_size, sample_size<span class="sc">/</span><span class="dv">2</span>, sample_size<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    N2 <span class="ot">&lt;-</span> sample_size <span class="sc">-</span> N1</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    DV1 <span class="ot">&lt;-</span> <span class="cf">if</span>(dists <span class="sc">==</span> <span class="st">'norm'</span>) <span class="fu">rnorm</span>(N1, <span class="at">sd=</span><span class="dv">1</span>) <span class="cf">else</span> <span class="fu">rchisq</span>(N1, <span class="at">df=</span><span class="dv">5</span>) <span class="sc">-</span> <span class="dv">5</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(dists <span class="sc">==</span> <span class="st">'norm'</span> <span class="sc">&amp;&amp;</span> same_dists){ </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        DV2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N2, <span class="at">sd=</span><span class="fu">sqrt</span>(variance.ratio))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        DV2 <span class="ot">&lt;-</span> (<span class="fu">rchisq</span>(N2, <span class="at">df=</span><span class="dv">5</span>) <span class="sc">-</span> <span class="dv">5</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(variance.ratio)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span>symmetric) DV2 <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="dv">0</span> <span class="sc">-</span> DV2)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DV=</span><span class="fu">c</span>(DV1, DV2 <span class="sc">+</span> mean_diff), </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">'g1'</span>, N1), <span class="fu">rep</span>(<span class="st">'g2'</span>, N2)))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    dat</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>Analyse <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, dat, <span class="at">fixed_objects =</span> <span class="cn">NULL</span>) {</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(DV <span class="sc">~</span> group, <span class="at">data=</span>dat, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    ret <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">detect=</span>test<span class="sc">$</span>p.value <span class="sc">&lt;</span> .<span class="dv">05</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    ret</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># note the omission of the summarise function</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">runSimulation</span>(<span class="at">design=</span>Design, <span class="at">replications=</span><span class="dv">20</span>, </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">generate=</span>Generate, <span class="at">analyse=</span>Analyse, <span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,920 × 8
   sample_size mean_diff variance.ratio equal_size dists same_dists symmetric
         &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;lgl&gt;      &lt;chr&gt; &lt;lgl&gt;      &lt;lgl&gt;    
 1         100      0.25              1 TRUE       skew  TRUE       TRUE     
 2         100      0.25              1 TRUE       skew  TRUE       TRUE     
 3         100      0.25              1 TRUE       skew  TRUE       TRUE     
 4         100      0.25              1 TRUE       skew  TRUE       TRUE     
 5         100      0.25              1 TRUE       skew  TRUE       TRUE     
 6         100      0.25              1 TRUE       skew  TRUE       TRUE     
 7         100      0.25              1 TRUE       skew  TRUE       TRUE     
 8         100      0.25              1 TRUE       skew  TRUE       TRUE     
 9         100      0.25              1 TRUE       skew  TRUE       TRUE     
10         100      0.25              1 TRUE       skew  TRUE       TRUE     
# ℹ 1,910 more rows
# ℹ 1 more variable: detect &lt;lgl&gt;</code></pre>
</div>
</div>
<p>Given these collected results, ANOVA-based approaches can be employed to investigate main and interaction effects for the recorded outcome variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># main effects only</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">aov</span>(detect <span class="sc">~</span> ., <span class="at">data=</span>res)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Df Sum Sq Mean Sq F value  Pr(&gt;F)    
sample_size       1    1.5     1.5    15.5 8.6e-05 ***
mean_diff         1   64.2    64.2   679.2 &lt; 2e-16 ***
variance.ratio    1    2.9     2.9    31.0 2.9e-08 ***
equal_size        1    1.1     1.1    11.2 0.00085 ***
dists             1    3.9     3.9    41.0 1.9e-10 ***
same_dists        1    9.5     9.5   100.5 &lt; 2e-16 ***
symmetric         1  110.4   110.4  1169.1 &lt; 2e-16 ***
Residuals      1912  180.6     0.1                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all two-way effects</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(detect <span class="sc">~</span> (.)<span class="sc">^</span><span class="dv">2</span>, <span class="at">data=</span>res)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
sample_size                   1    1.5     1.5   25.29 5.4e-07 ***
mean_diff                     1   64.2    64.2 1109.29 &lt; 2e-16 ***
variance.ratio                1    2.9     2.9   50.65 1.6e-12 ***
equal_size                    1    1.1     1.1   18.23 2.1e-05 ***
dists                         1    3.9     3.9   67.01 4.9e-16 ***
same_dists                    1    9.5     9.5  164.10 &lt; 2e-16 ***
symmetric                     1  110.4   110.4 1909.40 &lt; 2e-16 ***
sample_size:mean_diff         1    0.3     0.3    5.63  0.0178 *  
sample_size:variance.ratio    1    0.3     0.3    4.76  0.0292 *  
sample_size:equal_size        1    0.0     0.0    0.73  0.3932    
sample_size:dists             1    0.1     0.1    0.88  0.3477    
sample_size:same_dists        1    0.2     0.2    3.25  0.0716 .  
sample_size:symmetric         1    1.0     1.0   17.50 3.0e-05 ***
mean_diff:variance.ratio      1    1.0     1.0   16.65 4.7e-05 ***
mean_diff:equal_size          1    0.0     0.0    0.23  0.6352    
mean_diff:dists               1    0.3     0.3    5.83  0.0158 *  
mean_diff:same_dists          1    8.7     8.7  149.83 &lt; 2e-16 ***
mean_diff:symmetric           1   37.1    37.1  641.85 &lt; 2e-16 ***
variance.ratio:equal_size     1    0.3     0.3    4.76  0.0292 *  
variance.ratio:dists          1    0.5     0.5    7.94  0.0049 ** 
variance.ratio:same_dists     1    0.0     0.0    0.73  0.3932    
variance.ratio:symmetric      1    3.6     3.6   62.45 4.6e-15 ***
equal_size:dists              1    0.2     0.2    4.05  0.0443 *  
equal_size:same_dists         1    0.0     0.0    0.08  0.7759    
equal_size:symmetric          1    1.0     1.0   17.50 3.0e-05 ***
dists:same_dists              1   16.5    16.5  285.89 &lt; 2e-16 ***
same_dists:symmetric          1    0.0     0.0    0.05  0.8162    
Residuals                  1892  109.4     0.1                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all three-way effects</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">aov</span>(detect <span class="sc">~</span> (.)<span class="sc">^</span><span class="dv">3</span>, <span class="at">data=</span>res)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                        Df Sum Sq Mean Sq F value  Pr(&gt;F)    
sample_size                              1    1.5     1.5   32.96 1.1e-08 ***
mean_diff                                1   64.2    64.2 1445.48 &lt; 2e-16 ***
variance.ratio                           1    2.9     2.9   66.00 8.1e-16 ***
equal_size                               1    1.1     1.1   23.76 1.2e-06 ***
dists                                    1    3.9     3.9   87.31 &lt; 2e-16 ***
same_dists                               1    9.5     9.5  213.83 &lt; 2e-16 ***
symmetric                                1  110.4   110.4 2488.08 &lt; 2e-16 ***
sample_size:mean_diff                    1    0.3     0.3    7.33 0.00683 ** 
sample_size:variance.ratio               1    0.3     0.3    6.21 0.01281 *  
sample_size:equal_size                   1    0.0     0.0    0.95 0.32976    
sample_size:dists                        1    0.1     0.1    1.15 0.28373    
sample_size:same_dists                   1    0.2     0.2    4.24 0.03973 *  
sample_size:symmetric                    1    1.0     1.0   22.81 1.9e-06 ***
mean_diff:variance.ratio                 1    1.0     1.0   21.69 3.4e-06 ***
mean_diff:equal_size                     1    0.0     0.0    0.29 0.58817    
mean_diff:dists                          1    0.3     0.3    7.60 0.00588 ** 
mean_diff:same_dists                     1    8.7     8.7  195.24 &lt; 2e-16 ***
mean_diff:symmetric                      1   37.1    37.1  836.38 &lt; 2e-16 ***
variance.ratio:equal_size                1    0.3     0.3    6.21 0.01281 *  
variance.ratio:dists                     1    0.5     0.5   10.35 0.00132 ** 
variance.ratio:same_dists                1    0.0     0.0    0.95 0.32976    
variance.ratio:symmetric                 1    3.6     3.6   81.38 &lt; 2e-16 ***
equal_size:dists                         1    0.2     0.2    5.28 0.02169 *  
equal_size:same_dists                    1    0.0     0.0    0.11 0.74525    
equal_size:symmetric                     1    1.0     1.0   22.81 1.9e-06 ***
dists:same_dists                         1   16.5    16.5  372.54 &lt; 2e-16 ***
same_dists:symmetric                     1    0.0     0.0    0.07 0.79079    
sample_size:mean_diff:variance.ratio     1    0.5     0.5   11.28 0.00080 ***
sample_size:mean_diff:equal_size         1    0.0     0.0    0.01 0.91376    
sample_size:mean_diff:dists              1    1.1     1.1   24.03 1.0e-06 ***
sample_size:mean_diff:same_dists         1    0.0     0.0    0.29 0.58817    
sample_size:mean_diff:symmetric          1    1.4     1.4   31.04 2.9e-08 ***
sample_size:variance.ratio:equal_size    1    0.0     0.0    0.95 0.32976    
sample_size:variance.ratio:dists         1    0.7     0.7   14.67 0.00013 ***
sample_size:variance.ratio:same_dists    1    0.0     0.0    0.57 0.44841    
sample_size:variance.ratio:symmetric     1    1.0     1.0   22.81 1.9e-06 ***
sample_size:equal_size:dists             1    0.1     0.1    1.90 0.16817    
sample_size:equal_size:same_dists        1    0.1     0.1    1.98 0.15926    
sample_size:equal_size:symmetric         1    0.0     0.0    1.13 0.28870    
sample_size:dists:same_dists             1    0.1     0.1    2.35 0.12573    
sample_size:same_dists:symmetric         1    0.0     0.0    0.07 0.79079    
mean_diff:variance.ratio:equal_size      1    0.1     0.1    1.42 0.23361    
mean_diff:variance.ratio:dists           1    1.5     1.5   33.88 6.9e-09 ***
mean_diff:variance.ratio:same_dists      1    0.0     0.0    0.11 0.74525    
mean_diff:variance.ratio:symmetric       1    2.0     2.0   44.00 4.3e-11 ***
mean_diff:equal_size:dists               1    0.1     0.1    2.35 0.12573    
mean_diff:equal_size:same_dists          1    0.0     0.0    0.95 0.32976    
mean_diff:equal_size:symmetric           1    0.2     0.2    3.45 0.06343 .  
mean_diff:dists:same_dists               1   17.3    17.3  390.49 &lt; 2e-16 ***
mean_diff:same_dists:symmetric           1    0.0     0.0    0.28 0.59573    
variance.ratio:equal_size:dists          1    0.0     0.0    0.59 0.44382    
variance.ratio:equal_size:same_dists     1    0.2     0.2    3.39 0.06572 .  
variance.ratio:equal_size:symmetric      1    0.2     0.2    4.51 0.03392 *  
variance.ratio:dists:same_dists          1    0.1     0.1    3.38 0.06619 .  
variance.ratio:same_dists:symmetric      1    0.0     0.0    0.07 0.79079    
equal_size:dists:same_dists              1    0.0     0.0    0.84 0.35816    
equal_size:same_dists:symmetric          1    0.0     0.0    0.63 0.42615    
Residuals                             1862   82.7     0.0                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>and so on.</p>
</section>
<section id="fractional-factorial-experiments" class="level2">
<h2 class="anchored" data-anchor-id="fractional-factorial-experiments">Fractional factorial experiments</h2>
<p>When interest is primarily in detecting main and two-way interaction effects only then substantial gains can be made by using <em>fractional factorial</em> designs. A fractional factorial design is a reduced version of the fully factorial design, allowing for a more efficient use of resources as it reduces the sample size and number of conditions studied by way of discarding higher-order factor combinations.</p>
<p>Note that to use the <code>FrF2</code> package each factor must consist of exactly two-levels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FrF2)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># help(FrF2)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 7 factors with resolution 5</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">FrF2</span>(<span class="at">nfactors=</span><span class="dv">7</span>, <span class="at">resolution=</span><span class="dv">5</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>fr[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   A  B  C  D  E  F  G
1  1  1 -1 -1  1  1  1
2  1 -1  1  1  1  1 -1
3  1  1 -1  1 -1 -1 -1
4 -1 -1  1  1 -1 -1  1
5 -1 -1  1  1 -1  1 -1
6 -1 -1  1 -1 -1  1  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create working simulation design given -1/1 combinations</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fDesign <span class="ot">&lt;-</span> <span class="fu">createDesign</span>(<span class="at">sample_size=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">200</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mean_diff=</span><span class="fu">c</span>(.<span class="dv">25</span>, <span class="dv">2</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variance.ratio=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">equal_size=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dists=</span><span class="fu">c</span>(<span class="st">'norm'</span>, <span class="st">'skew'</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">same_dists=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">symmetric=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># remove same-normal combo</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">subset =</span> <span class="sc">!</span>(symmetric <span class="sc">&amp;</span> dists <span class="sc">==</span> <span class="st">'norm'</span>),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fractional=</span>fr)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>fDesign</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 7
   sample_size mean_diff variance.ratio equal_size dists same_dists symmetric
         &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;lgl&gt;      &lt;chr&gt; &lt;lgl&gt;      &lt;lgl&gt;    
 1         100      2                 4 FALSE      norm  TRUE       FALSE    
 2         100      0.25              1 FALSE      skew  FALSE      FALSE    
 3         200      2                 4 FALSE      skew  FALSE      TRUE     
 4         200      2                 4 FALSE      skew  TRUE       FALSE    
 5         200      2                 4 TRUE       skew  TRUE       TRUE     
 6         200      2                 1 FALSE      skew  TRUE       TRUE     
 7         100      2                 1 FALSE      skew  FALSE      TRUE     
 8         100      0.25              4 TRUE       skew  FALSE      FALSE    
 9         200      2                 1 FALSE      norm  TRUE       FALSE    
10         200      0.25              4 FALSE      skew  FALSE      FALSE    
# ℹ 38 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fDesign)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48  7</code></pre>
</div>
</div>
<p>Notice that the fractional factor design has fewer condition than the fully-crossed version above. However, despite this reduced number of conditions valid main and two-way interaction effects are still estimable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note the omission of the summarise function</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fres <span class="ot">&lt;-</span> <span class="fu">runSimulation</span>(<span class="at">design=</span>fDesign, <span class="at">replications=</span><span class="dv">20</span>, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">generate=</span>Generate, <span class="at">analyse=</span>Analyse, <span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>fres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 960 × 8
   sample_size mean_diff variance.ratio equal_size dists same_dists symmetric
         &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;lgl&gt;      &lt;chr&gt; &lt;lgl&gt;      &lt;lgl&gt;    
 1         100         2              4 FALSE      norm  TRUE       FALSE    
 2         100         2              4 FALSE      norm  TRUE       FALSE    
 3         100         2              4 FALSE      norm  TRUE       FALSE    
 4         100         2              4 FALSE      norm  TRUE       FALSE    
 5         100         2              4 FALSE      norm  TRUE       FALSE    
 6         100         2              4 FALSE      norm  TRUE       FALSE    
 7         100         2              4 FALSE      norm  TRUE       FALSE    
 8         100         2              4 FALSE      norm  TRUE       FALSE    
 9         100         2              4 FALSE      norm  TRUE       FALSE    
10         100         2              4 FALSE      norm  TRUE       FALSE    
# ℹ 950 more rows
# ℹ 1 more variable: detect &lt;lgl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># main effects only</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">aov</span>(detect <span class="sc">~</span> ., <span class="at">data=</span>fres)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Df Sum Sq Mean Sq F value  Pr(&gt;F)    
sample_size      1    0.2     0.2    2.18    0.14    
mean_diff        1   32.3    32.3  344.21 &lt; 2e-16 ***
variance.ratio   1    1.5     1.5   16.05 6.7e-05 ***
equal_size       1    0.1     0.1    0.71    0.40    
dists            1    2.4     2.4   25.69 4.8e-07 ***
same_dists       1    3.5     3.5   37.38 1.4e-09 ***
symmetric        1   57.6    57.6  614.46 &lt; 2e-16 ***
Residuals      952   89.2     0.1                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all two-way effects</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(detect <span class="sc">~</span> (.)<span class="sc">^</span><span class="dv">2</span>, <span class="at">data=</span>fres)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            Df Sum Sq Mean Sq F value  Pr(&gt;F)    
sample_size                  1    0.2     0.2    3.51  0.0612 .  
mean_diff                    1   32.3    32.3  555.36 &lt; 2e-16 ***
variance.ratio               1    1.5     1.5   25.89 4.4e-07 ***
equal_size                   1    0.1     0.1    1.15  0.2844    
dists                        1    2.4     2.4   41.45 1.9e-10 ***
same_dists                   1    3.5     3.5   60.31 2.1e-14 ***
symmetric                    1   57.6    57.6  991.38 &lt; 2e-16 ***
sample_size:mean_diff        1    0.3     0.3    4.59  0.0324 *  
sample_size:variance.ratio   1    0.0     0.0    0.07  0.7889    
sample_size:equal_size       1    0.6     0.6   10.33  0.0014 ** 
sample_size:dists            1    0.0     0.0    0.57  0.4490    
sample_size:same_dists       1    0.0     0.0    0.07  0.7889    
sample_size:symmetric        1    0.2     0.2    3.87  0.0494 *  
mean_diff:variance.ratio     1    0.1     0.1    1.15  0.2844    
mean_diff:equal_size         1    0.0     0.0    0.07  0.7889    
mean_diff:dists              1    0.1     0.1    0.90  0.3440    
mean_diff:same_dists         1    3.7     3.7   64.54 2.8e-15 ***
mean_diff:symmetric          1   20.3    20.3  349.50 &lt; 2e-16 ***
variance.ratio:equal_size    1    0.2     0.2    2.58  0.1084    
variance.ratio:dists         1    0.0     0.0    0.14  0.7050    
variance.ratio:same_dists    1    0.0     0.0    0.65  0.4220    
variance.ratio:symmetric     1    0.9     0.9   15.49 8.9e-05 ***
equal_size:dists             1    0.1     0.1    0.90  0.3440    
equal_size:same_dists        1    0.1     0.1    1.15  0.2844    
equal_size:symmetric         1    0.0     0.0    0.11  0.7430    
dists:same_dists             1    8.5     8.5  146.87 &lt; 2e-16 ***
same_dists:symmetric         1    0.0     0.0    0.43  0.5120    
Residuals                  932   54.1     0.1                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Going even further, if only two-way interaction with respect to the first factor is of interest (<code>sample_size</code>) then a resolution 4 input can be used, further reducing the total number of conditions to evaluate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7 factors with resolution 4</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">FrF2</span>(<span class="at">nfactors=</span><span class="dv">7</span>, <span class="at">resolution=</span><span class="dv">4</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create working simulation design given -1/1 combinations</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>fDesign <span class="ot">&lt;-</span> <span class="fu">createDesign</span>(<span class="at">sample_size=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">200</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mean_diff=</span><span class="fu">c</span>(.<span class="dv">25</span>, <span class="dv">2</span>),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">variance.ratio=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">equal_size=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dists=</span><span class="fu">c</span>(<span class="st">'norm'</span>, <span class="st">'skew'</span>),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">same_dists=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">symmetric=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># remove same-normal combo</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">subset =</span> <span class="sc">!</span>(symmetric <span class="sc">&amp;</span> dists <span class="sc">==</span> <span class="st">'norm'</span>),</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fractional=</span>fr)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>fDesign</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 7
   sample_size mean_diff variance.ratio equal_size dists same_dists symmetric
         &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;lgl&gt;      &lt;chr&gt; &lt;lgl&gt;      &lt;lgl&gt;    
 1         100      2                 1 TRUE       skew  FALSE      TRUE     
 2         200      0.25              1 FALSE      skew  TRUE       TRUE     
 3         100      0.25              4 FALSE      skew  FALSE      TRUE     
 4         200      0.25              4 FALSE      norm  TRUE       FALSE    
 5         200      2                 4 FALSE      skew  FALSE      FALSE    
 6         200      0.25              1 TRUE       skew  FALSE      FALSE    
 7         200      2                 4 TRUE       skew  TRUE       TRUE     
 8         100      2                 1 FALSE      skew  TRUE       FALSE    
 9         100      0.25              1 FALSE      norm  FALSE      FALSE    
10         200      2                 1 TRUE       norm  TRUE       FALSE    
11         100      0.25              4 TRUE       skew  TRUE       FALSE    
12         100      2                 4 TRUE       norm  FALSE      FALSE    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note the omission of the summarise function</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fres <span class="ot">&lt;-</span> <span class="fu">runSimulation</span>(<span class="at">design=</span>fDesign, <span class="at">replications=</span><span class="dv">20</span>, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">generate=</span>Generate, <span class="at">analyse=</span>Analyse, <span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>fres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 240 × 8
   sample_size mean_diff variance.ratio equal_size dists same_dists symmetric
         &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;lgl&gt;      &lt;chr&gt; &lt;lgl&gt;      &lt;lgl&gt;    
 1         100         2              1 TRUE       skew  FALSE      TRUE     
 2         100         2              1 TRUE       skew  FALSE      TRUE     
 3         100         2              1 TRUE       skew  FALSE      TRUE     
 4         100         2              1 TRUE       skew  FALSE      TRUE     
 5         100         2              1 TRUE       skew  FALSE      TRUE     
 6         100         2              1 TRUE       skew  FALSE      TRUE     
 7         100         2              1 TRUE       skew  FALSE      TRUE     
 8         100         2              1 TRUE       skew  FALSE      TRUE     
 9         100         2              1 TRUE       skew  FALSE      TRUE     
10         100         2              1 TRUE       skew  FALSE      TRUE     
# ℹ 230 more rows
# ℹ 1 more variable: detect &lt;lgl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># main effects</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">aov</span>(detect <span class="sc">~</span> ., <span class="at">data=</span>fres)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Df Sum Sq Mean Sq F value  Pr(&gt;F)    
sample_size      1   1.35    1.35   19.72 1.4e-05 ***
mean_diff        1   8.82    8.82  128.78 &lt; 2e-16 ***
variance.ratio   1   2.02    2.02   29.46 1.4e-07 ***
equal_size       1   4.41    4.41   64.39 5.1e-14 ***
dists            1   0.30    0.30    4.38  0.0374 *  
same_dists       1   0.68    0.68    9.86  0.0019 ** 
symmetric        1  14.40   14.40  210.33 &lt; 2e-16 ***
Residuals      232  15.88    0.07                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two-way interaction effects for sample_size only</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(detect <span class="sc">~</span> (.)<span class="sc">^</span><span class="dv">2</span>, <span class="at">data=</span>fres)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            Df Sum Sq Mean Sq F value  Pr(&gt;F)    
sample_size                  1   1.35    1.35   27.98 2.9e-07 ***
mean_diff                    1   8.82    8.82  182.75 &lt; 2e-16 ***
variance.ratio               1   2.02    2.02   41.80 6.1e-10 ***
equal_size                   1   4.41    4.41   91.37 &lt; 2e-16 ***
dists                        1   0.30    0.30    6.22 0.01335 *  
same_dists                   1   0.68    0.68   13.99 0.00023 ***
symmetric                    1  14.40   14.40  298.47 &lt; 2e-16 ***
sample_size:mean_diff        1   2.13    2.13   44.22 2.1e-10 ***
sample_size:variance.ratio   1   0.62    0.62   12.95 0.00039 ***
sample_size:equal_size       1   0.10    0.10    2.07 0.15132    
sample_size:dists            1   2.03    2.03   41.97 5.6e-10 ***
Residuals                  228  11.00    0.05                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<ul>
<li>Montgomery, Douglas C. (2017). <em>Design and Analysis of Experiments (9th ed.)</em>. John Wiley &amp; Sons, Inc.</li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    window.setColorSchemeToggle(window.hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>