<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Phil Chalmers">

<title>Kang and Cohen (2007) simulation 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="KangCohen2007_files/libs/clipboard/clipboard.min.js"></script>
<script src="KangCohen2007_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="KangCohen2007_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="KangCohen2007_files/libs/quarto-html/popper.min.js"></script>
<script src="KangCohen2007_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="KangCohen2007_files/libs/quarto-html/anchor.min.js"></script>
<link href="KangCohen2007_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="KangCohen2007_files/libs/quarto-html/quarto-syntax-highlighting-fe31d7bd2deb2a321418d01dba375a64.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="KangCohen2007_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="KangCohen2007_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="KangCohen2007_files/libs/bootstrap/bootstrap-f88d85d511a9fa5e18577bcbd939f5a9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Kang and Cohen (2007) simulation 2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Phil Chalmers </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Simulation from:</p>
<ul>
<li>Kang T, Cohen AS. IRT Model Selection Methods for Dichotomous Items. Applied Psychological Measurement. 2007;31(4):331-358. doi:10.1177/0146621606292213</li>
<li>https://journals.sagepub.com/doi/10.1177/0146621606292213</li>
</ul>
<p>However, this simulation is only a partial one as I was mainly interested in replicating the IRT estimation results that utilized modal estimation rather than a complete MCMC form. Plus, the article reports the DIC information criteria for the Bayesian models, which these days is generally regarded as sub-optimal. Moreover, computation of a partial Bayes factor could have been replaced with a Bayes factor computation via bridge-sampling methods.</p>
<section id="simulation-code" class="level1">
<h1>Simulation code</h1>
<p>The following code uses <em>TODO</em> placeholders in case users are interested in investigating the MCMC results themselves in the context of this code-base.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SimDesign::SimFunctions(nAnalyse=2)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SimDesign)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Design <span class="ot">&lt;-</span> <span class="fu">createDesign</span>(<span class="at">nitems =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">40</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ability_mean =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sample_size =</span> <span class="fu">c</span>(<span class="dv">500</span>,<span class="dv">1000</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model =</span> <span class="fu">c</span>(<span class="st">'1PL'</span>,<span class="st">'2PL'</span>,<span class="st">'3PL'</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">estimator=</span><span class="fu">c</span>(<span class="st">'MML'</span>)) <span class="co"># add 'MCMC' when supported</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>Design</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># source in helper functions + fixed_objects definition</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"KangCohen2007_extras.R"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>Generate <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, <span class="at">fixed_objects =</span> <span class="cn">NULL</span>) {</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Attach</span>(condition)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get population generating parameters</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(sample_size, <span class="at">mean=</span>ability_mean))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    pars <span class="ot">&lt;-</span> <span class="fu">get_parameters</span>(condition, fixed_objects)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulate response data (via mirt)</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">with</span>(pars, </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>                <span class="fu">simdata</span>(sample_size, <span class="at">a=</span>a, <span class="at">d=</span>d, <span class="at">guess=</span>c, </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Theta =</span> theta, <span class="at">itemtype =</span> <span class="st">'3PL'</span>))</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    dat</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>Analyse.MML <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, dat, <span class="at">fixed_objects =</span> <span class="cn">NULL</span>) {</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Attach</span>(condition)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AnalyseIf</span>(estimator <span class="sc">==</span> <span class="st">"MML"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MML estimation</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"Theta = 1-%i</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="st">                   START = (1-%i, a1, 1.0)</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="st">                   FIXED = (1-%i, a1)"</span>, nitems, nitems, nitems)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    mod1PL <span class="ot">&lt;-</span> <span class="fu">mirt</span>(dat, <span class="at">model=</span>fit, <span class="at">itemtype=</span><span class="st">'2PL'</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    mod2PL <span class="ot">&lt;-</span> <span class="fu">mirt</span>(dat, <span class="at">model=</span><span class="dv">1</span>, <span class="at">itemtype=</span><span class="st">'2PL'</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    mod3PL <span class="ot">&lt;-</span> <span class="fu">mirt</span>(dat, <span class="at">model=</span><span class="dv">1</span>, <span class="at">itemtype=</span><span class="st">'3PL'</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">extract.mirt</span>(mod1PL, <span class="st">'converged'</span>))</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">extract.mirt</span>(mod2PL, <span class="st">'converged'</span>))</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">extract.mirt</span>(mod3PL, <span class="st">'converged'</span>))</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># just return model comparison information (main purpose of the paper)</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    ret <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">c</span>(<span class="at">M1PL=</span><span class="fu">anova</span>(mod1PL)[<span class="fu">c</span>(<span class="st">'AIC'</span>, <span class="st">'BIC'</span>)], </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                           <span class="at">M2PL=</span><span class="fu">anova</span>(mod2PL)[<span class="fu">c</span>(<span class="st">'AIC'</span>, <span class="st">'BIC'</span>)],</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>                           <span class="at">M3PL=</span><span class="fu">anova</span>(mod3PL)[<span class="fu">c</span>(<span class="st">'AIC'</span>, <span class="st">'BIC'</span>)],</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>                           <span class="at">LR12=</span><span class="fu">anova</span>(mod1PL, mod2PL, <span class="at">verbose=</span><span class="cn">FALSE</span>)[<span class="dv">2</span>, <span class="fu">c</span>(<span class="st">'X2'</span>, <span class="st">'p'</span>)],</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                           <span class="at">LR23=</span><span class="fu">anova</span>(mod2PL, mod3PL, <span class="at">verbose=</span><span class="cn">FALSE</span>)[<span class="dv">2</span>, <span class="fu">c</span>(<span class="st">'X2'</span>, <span class="st">'p'</span>)]))</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    ret</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>Analyse.MCMC <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, dat, <span class="at">fixed_objects =</span> <span class="cn">NULL</span>) {</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Attach</span>(condition)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AnalyseIf</span>(estimator <span class="sc">==</span> <span class="st">"MCMC"</span>)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>Summarise <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, results, <span class="at">fixed_objects =</span> <span class="cn">NULL</span>) {</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    nms <span class="ot">&lt;-</span> <span class="fu">colnames</span>(results)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    means <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(results[,<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">".p</span><span class="sc">\\</span><span class="st">b"</span>, nms)])</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    sds <span class="ot">&lt;-</span> <span class="fu">apply</span>(results[,<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">".p</span><span class="sc">\\</span><span class="st">b"</span>, nms)], <span class="dv">2</span>, sd)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    BIC <span class="ot">&lt;-</span> <span class="fu">best_info</span>(results[,<span class="fu">grepl</span>(<span class="st">".BIC"</span>, nms)])</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    ret <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">means=</span>means, <span class="at">sds=</span>sds, BIC)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(condition<span class="sc">$</span>estimator <span class="sc">==</span> <span class="st">'MML'</span>){</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>        AIC <span class="ot">&lt;-</span> <span class="fu">best_info</span>(results[,<span class="fu">grepl</span>(<span class="st">".AIC</span><span class="sc">\\</span><span class="st">b"</span>, nms)])</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>        ps <span class="ot">&lt;-</span> results[,<span class="fu">grepl</span>(<span class="st">".p</span><span class="sc">\\</span><span class="st">b"</span>, nms)] <span class="sc">&lt;</span> .<span class="dv">05</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>        ps[ps[,<span class="dv">2</span>], <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">FALSE</span>     <span class="do">## if 3PLM test sig, 1PL vs 2PL doesn't matter</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>        LR <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(<span class="fu">cbind</span>(<span class="fu">ifelse</span>(<span class="fu">rowSums</span>(ps) <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>), ps))</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(LR) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'M1PL.LR'</span>, <span class="st">'M2PL.LR'</span>, <span class="st">'M3PL.LR'</span>)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>        ret <span class="ot">&lt;-</span> <span class="fu">c</span>(ret, AIC, LR)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    ret</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">runSimulation</span>(<span class="at">design=</span>Design, <span class="at">replications=</span><span class="dv">500</span>, <span class="at">generate=</span>Generate, </span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>                     <span class="at">analyse=</span><span class="fu">list</span>(Analyse.MML, Analyse.MCMC), <span class="co"># unnamed list to avoid extra labels</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>                     <span class="at">summarise=</span>Summarise, <span class="at">fixed_objects=</span>fo,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>                     <span class="at">packages=</span><span class="st">'mirt'</span>, <span class="at">parallel=</span><span class="cn">TRUE</span>, <span class="at">max_errors =</span> <span class="cn">Inf</span>, </span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>                     <span class="at">filename=</span><span class="st">'KangCohen'</span>)</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 36
   nitems ability_mean sample_size model estimator means.M1PL.AIC means.M1PL.BIC
    &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;          &lt;dbl&gt;
 1     20            0         500 1PL   MML               11752.         11836.
 2     40            0         500 1PL   MML               22827.         22996.
 3     20           -1         500 1PL   MML               10904.         10988.
 4     40           -1         500 1PL   MML               20718.         20886.
 5     20            1         500 1PL   MML               10516.         10600.
 6     40            1         500 1PL   MML               20943.         21112.
 7     20            0        1000 1PL   MML               23495.         23593.
 8     40            0        1000 1PL   MML               45625.         45821.
 9     20           -1        1000 1PL   MML               21806.         21905.
10     40           -1        1000 1PL   MML               41344.         41540.
# ℹ 26 more rows
# ℹ 29 more variables: means.M2PL.AIC &lt;dbl&gt;, means.M2PL.BIC &lt;dbl&gt;,
#   means.M3PL.AIC &lt;dbl&gt;, means.M3PL.BIC &lt;dbl&gt;, means.LR12.X2 &lt;dbl&gt;,
#   means.LR23.X2 &lt;dbl&gt;, sds.M1PL.AIC &lt;dbl&gt;, sds.M1PL.BIC &lt;dbl&gt;,
#   sds.M2PL.AIC &lt;dbl&gt;, sds.M2PL.BIC &lt;dbl&gt;, sds.M3PL.AIC &lt;dbl&gt;,
#   sds.M3PL.BIC &lt;dbl&gt;, sds.LR12.X2 &lt;dbl&gt;, sds.LR23.X2 &lt;dbl&gt;, M1PL.BIC &lt;dbl&gt;,
#   M2PL.BIC &lt;dbl&gt;, M3PL.BIC &lt;dbl&gt;, M1PL.AIC &lt;dbl&gt;, M2PL.AIC &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="replication-of-several-tables-and-figures" class="level1">
<h1>Replication of several Tables and Figures</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># information criteria means/sds</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>Table6_means <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model <span class="sc">==</span> <span class="st">"1PL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(nitems<span class="sc">:</span>sample_size, estimator, means.M1PL.AIC<span class="sc">:</span>means.LR23.X2)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Table6_sds <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model <span class="sc">==</span> <span class="st">"1PL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(nitems<span class="sc">:</span>sample_size, estimator, sds.M1PL.AIC<span class="sc">:</span>sds.LR23.X2)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>Table6_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 12
   nitems ability_mean sample_size estimator means.M1PL.AIC means.M1PL.BIC
    &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;          &lt;dbl&gt;
 1     20            0         500 MML               11752.         11836.
 2     40            0         500 MML               22827.         22996.
 3     20           -1         500 MML               10904.         10988.
 4     40           -1         500 MML               20718.         20886.
 5     20            1         500 MML               10516.         10600.
 6     40            1         500 MML               20943.         21112.
 7     20            0        1000 MML               23495.         23593.
 8     40            0        1000 MML               45625.         45821.
 9     20           -1        1000 MML               21806.         21905.
10     40           -1        1000 MML               41344.         41540.
11     20            1        1000 MML               21029.         21128.
12     40            1        1000 MML               41834.         42030.
# ℹ 6 more variables: means.M2PL.AIC &lt;dbl&gt;, means.M2PL.BIC &lt;dbl&gt;,
#   means.M3PL.AIC &lt;dbl&gt;, means.M3PL.BIC &lt;dbl&gt;, means.LR12.X2 &lt;dbl&gt;,
#   means.LR23.X2 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Table6_sds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 12
   nitems ability_mean sample_size estimator sds.M1PL.AIC sds.M1PL.BIC
    &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;
 1     20            0         500 MML             89.760       89.760
 2     40            0         500 MML            171.49       171.49 
 3     20           -1         500 MML            128.20       128.20 
 4     40           -1         500 MML            242.41       242.41 
 5     20            1         500 MML            140.10       140.10 
 6     40            1         500 MML            211.36       211.36 
 7     20            0        1000 MML            126.89       126.89 
 8     40            0        1000 MML            236.82       236.82 
 9     20           -1        1000 MML            169.64       169.64 
10     40           -1        1000 MML            330.16       330.16 
11     20            1        1000 MML            191.37       191.37 
12     40            1        1000 MML            330.26       330.26 
# ℹ 6 more variables: sds.M2PL.AIC &lt;dbl&gt;, sds.M2PL.BIC &lt;dbl&gt;,
#   sds.M3PL.AIC &lt;dbl&gt;, sds.M3PL.BIC &lt;dbl&gt;, sds.LR12.X2 &lt;dbl&gt;,
#   sds.LR23.X2 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Table7_means <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model <span class="sc">==</span> <span class="st">"2PL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(nitems<span class="sc">:</span>sample_size, estimator, means.M1PL.AIC<span class="sc">:</span>means.LR23.X2)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Table7_sds <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model <span class="sc">==</span> <span class="st">"2PL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(nitems<span class="sc">:</span>sample_size, estimator, sds.M1PL.AIC<span class="sc">:</span>sds.LR23.X2)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>Table7_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 12
   nitems ability_mean sample_size estimator means.M1PL.AIC means.M1PL.BIC
    &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;          &lt;dbl&gt;
 1     20            0         500 MML               11639.         11724.
 2     40            0         500 MML               22464.         22632.
 3     20           -1         500 MML               10552.         10636.
 4     40           -1         500 MML               20040.         20209.
 5     20            1         500 MML               10468.         10553.
 6     40            1         500 MML               20677.         20846.
 7     20            0        1000 MML               23244.         23342.
 8     40            0        1000 MML               44924.         45120.
 9     20           -1        1000 MML               21090.         21188.
10     40           -1        1000 MML               40082.         40279.
11     20            1        1000 MML               20918.         21016.
12     40            1        1000 MML               41319.         41515.
# ℹ 6 more variables: means.M2PL.AIC &lt;dbl&gt;, means.M2PL.BIC &lt;dbl&gt;,
#   means.M3PL.AIC &lt;dbl&gt;, means.M3PL.BIC &lt;dbl&gt;, means.LR12.X2 &lt;dbl&gt;,
#   means.LR23.X2 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Table7_sds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 12
   nitems ability_mean sample_size estimator sds.M1PL.AIC sds.M1PL.BIC
    &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;
 1     20            0         500 MML             86.271       86.271
 2     40            0         500 MML            151.07       151.07 
 3     20           -1         500 MML            128.38       128.38 
 4     40           -1         500 MML            221.59       221.59 
 5     20            1         500 MML            124.54       124.54 
 6     40            1         500 MML            219.77       219.77 
 7     20            0        1000 MML            131.34       131.34 
 8     40            0        1000 MML            215.62       215.62 
 9     20           -1        1000 MML            172.37       172.37 
10     40           -1        1000 MML            318.69       318.69 
11     20            1        1000 MML            196.67       196.67 
12     40            1        1000 MML            304.49       304.49 
# ℹ 6 more variables: sds.M2PL.AIC &lt;dbl&gt;, sds.M2PL.BIC &lt;dbl&gt;,
#   sds.M3PL.AIC &lt;dbl&gt;, sds.M3PL.BIC &lt;dbl&gt;, sds.LR12.X2 &lt;dbl&gt;,
#   sds.LR23.X2 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Table8_means <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model <span class="sc">==</span> <span class="st">"3PL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(nitems<span class="sc">:</span>sample_size, estimator, means.M1PL.AIC<span class="sc">:</span>means.LR23.X2)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>Table8_sds <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model <span class="sc">==</span> <span class="st">"3PL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(nitems<span class="sc">:</span>sample_size, estimator, sds.M1PL.AIC<span class="sc">:</span>sds.LR23.X2)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>Table8_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 12
   nitems ability_mean sample_size estimator means.M1PL.AIC means.M1PL.BIC
    &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;          &lt;dbl&gt;
 1     20            0         500 MML              11090.         11174. 
 2     40            0         500 MML              22297.         22465. 
 3     20           -1         500 MML              12674.         12758. 
 4     40           -1         500 MML              25272.         25441. 
 5     20            1         500 MML               8540.0         8624.3
 6     40            1         500 MML              17425.         17594. 
 7     20            0        1000 MML              22268.         22366. 
 8     40            0        1000 MML              44570.         44766. 
 9     20           -1        1000 MML              25422.         25521. 
10     40           -1        1000 MML              50583.         50779. 
11     20            1        1000 MML              17146.         17244. 
12     40            1        1000 MML              34812.         35008. 
# ℹ 6 more variables: means.M2PL.AIC &lt;dbl&gt;, means.M2PL.BIC &lt;dbl&gt;,
#   means.M3PL.AIC &lt;dbl&gt;, means.M3PL.BIC &lt;dbl&gt;, means.LR12.X2 &lt;dbl&gt;,
#   means.LR23.X2 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Table8_sds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 12
   nitems ability_mean sample_size estimator sds.M1PL.AIC sds.M1PL.BIC
    &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;
 1     20            0         500 MML             281.58       281.58
 2     40            0         500 MML             413.93       413.93
 3     20           -1         500 MML             246.03       246.03
 4     40           -1         500 MML             336.87       336.87
 5     20            1         500 MML             303.05       303.05
 6     40            1         500 MML             420.76       420.76
 7     20            0        1000 MML             486.20       486.20
 8     40            0        1000 MML             762.52       762.52
 9     20           -1        1000 MML             444.38       444.38
10     40           -1        1000 MML             663.71       663.71
11     20            1        1000 MML             568.87       568.87
12     40            1        1000 MML             795.56       795.56
# ℹ 6 more variables: sds.M2PL.AIC &lt;dbl&gt;, sds.M2PL.BIC &lt;dbl&gt;,
#   sds.M3PL.AIC &lt;dbl&gt;, sds.M3PL.BIC &lt;dbl&gt;, sds.LR12.X2 &lt;dbl&gt;,
#   sds.LR23.X2 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">##################################</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="do">## proportion of competing models selected (more general measure than nose count)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Table9 <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(estimator <span class="sc">==</span> <span class="st">"MML"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(nitems<span class="sc">:</span>model, M1PL.BIC<span class="sc">:</span>M3PL.LR) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(nitems, sample_size, ability_mean, model)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>Table9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 13
   nitems ability_mean sample_size model M1PL.BIC M2PL.BIC M3PL.BIC M1PL.AIC
    &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1     20           -1         500 1PL      1        0            0    0.992
 2     20           -1         500 2PL      0.018    0.982        0    0    
 3     20           -1         500 3PL      0        1            0    0    
 4     20            0         500 1PL      1        0            0    0.994
 5     20            0         500 2PL      0        1            0    0    
 6     20            0         500 3PL      0.268    0.732        0    0    
 7     20            1         500 1PL      1        0            0    0.996
 8     20            1         500 2PL      0.004    0.996        0    0    
 9     20            1         500 3PL      0.786    0.214        0    0    
10     20           -1        1000 1PL      1        0            0    0.998
# ℹ 26 more rows
# ℹ 5 more variables: M2PL.AIC &lt;dbl&gt;, M3PL.AIC &lt;dbl&gt;, M1PL.LR &lt;dbl&gt;,
#   M2PL.LR &lt;dbl&gt;, M3PL.LR &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">##################################</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># graphics</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>long <span class="ot">&lt;-</span> Table9 <span class="sc">%&gt;%</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(M1PL.BIC<span class="sc">:</span>M3PL.LR, <span class="at">names_to=</span><span class="st">'fit_stat'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">separate</span>(fit_stat, <span class="fu">c</span>(<span class="st">'fit'</span>, <span class="st">'stat'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">stat=</span><span class="fu">factor</span>(stat), <span class="at">fit=</span><span class="fu">factor</span>(fit), <span class="at">model=</span><span class="fu">factor</span>(model))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 324 × 7
   nitems ability_mean sample_size model fit   stat  value
    &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt;
 1     20           -1         500 1PL   M1PL  BIC   1    
 2     20           -1         500 1PL   M2PL  BIC   0    
 3     20           -1         500 1PL   M3PL  BIC   0    
 4     20           -1         500 1PL   M1PL  AIC   0.992
 5     20           -1         500 1PL   M2PL  AIC   0.008
 6     20           -1         500 1PL   M3PL  AIC   0    
 7     20           -1         500 1PL   M1PL  LR    0.93 
 8     20           -1         500 1PL   M2PL  LR    0.068
 9     20           -1         500 1PL   M3PL  LR    0.002
10     20           -1         500 2PL   M1PL  BIC   0.018
# ℹ 314 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unnormalized</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(long, aes(x=fit, y=value, fill=stat)) +</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_bar(stat = "identity", position = 'dodge') + </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     facet_grid(model ~ nitems)</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>sub1 <span class="ot">&lt;-</span> long <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(fit, stat, model, nitems) <span class="sc">%&gt;%</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mvalue =</span> <span class="fu">mean</span>(value)) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(model, stat, nitems) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">value =</span> mvalue <span class="sc">/</span> <span class="fu">sum</span>(mvalue)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'fit', 'stat', 'model'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(fig1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sub1, <span class="fu">aes</span>(<span class="at">x=</span>fit, <span class="at">y=</span>value, <span class="at">fill=</span>stat)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">'dodge'</span>) <span class="sc">+</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_grid</span>(model <span class="sc">~</span> nitems)) <span class="sc">+</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Figure 1"</span>, <span class="at">subtitle =</span> <span class="st">"Model Selection Proportions by Test Length"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="KangCohen2007_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unnormalized</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(long, aes(x=fit, y=value, fill=stat)) +</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#         geom_bar(stat = "identity", position = 'dodge') +</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#         facet_grid(model ~ sample_size)</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>sub2 <span class="ot">&lt;-</span> long <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(fit, stat, model, sample_size) <span class="sc">%&gt;%</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mvalue =</span> <span class="fu">mean</span>(value)) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(model, stat, sample_size) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">value =</span> mvalue <span class="sc">/</span> <span class="fu">sum</span>(mvalue)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'fit', 'stat', 'model'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sub2, <span class="fu">aes</span>(<span class="at">x=</span>fit, <span class="at">y=</span>value, <span class="at">fill=</span>stat)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">'dodge'</span>) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(model <span class="sc">~</span> sample_size) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Figure 2"</span>, <span class="at">subtitle =</span> <span class="st">"Model Selection Proportions by Sample Size"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="KangCohen2007_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unnormalized</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(long, aes(x=fit, y=value, fill=stat)) +</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#         geom_bar(stat = "identity", position = 'dodge') + </span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#         facet_grid(model ~ ability_mean)</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>sub3 <span class="ot">&lt;-</span> long <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(fit, stat, model, ability_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mvalue =</span> <span class="fu">mean</span>(value)) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(model, stat, ability_mean) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">value =</span> mvalue <span class="sc">/</span> <span class="fu">sum</span>(mvalue)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'fit', 'stat', 'model'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sub3, <span class="fu">aes</span>(<span class="at">x=</span>fit, <span class="at">y=</span>value, <span class="at">fill=</span>stat)) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">'dodge'</span>) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(model <span class="sc">~</span> ability_mean)  <span class="sc">+</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Figure 3"</span>, <span class="at">subtitle =</span> <span class="st">"Model Selection Proportions by Ability Distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="KangCohen2007_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="replication-comments" class="level1">
<h1>Replication comments</h1>
<p>The results generally replicate well using the <code>mirt</code> software instead of <code>BILOG-MG</code>, at least for the 1PL and 2PL models. For the 3PL models, it seems that <code>mirt</code> was better able to determine whether the true model was in fact from a population generated with 3PL models when using the likelihood ratio approach, as well as the AIC criteria (see the bottom rows of the above 3 figures in comparison to the original figures in Kang and Cohen, 2007). Similar patterns appear for BIC as well, though it’s not entirely clear whether this is due to Monte Carlo sampling error or not (original paper used <span class="math inline">\(R=50\)</span> replication per cell, whereas this simulation used <span class="math inline">\(R=500\)</span>).</p>
<p>In any event, it’s unclear why exactly this is the case (perhaps it’s due to <code>mirt</code>’s logit transformed version of the pseudo-guessing parameter during estimation?) but in any case it seems that correctly selecting the 3PL model using the likelihood-ratio test may not be as poor as the author’s originally observed. As such, I’d be more inclined to recommend using the likelihood ratio statistics or AIC when selecting between competing models,</p>
<p>Note that the above replication does not collapse the <span class="math inline">\(N(-1,1)\)</span> and <span class="math inline">\(N(1,1)\)</span> ability distribution results into a single object as these distributions have very different behaviour in the model comparison results (as they should for the 3PL model, as higher ability individuals would be less influenced by guessing, so the pseudo-guessing parameter would have notably more sampling variability). It’s unclear why the authors chose to collapse these categories, but in any event based on the above results alone I would advise against doing so as the marginal results may be misleading.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>