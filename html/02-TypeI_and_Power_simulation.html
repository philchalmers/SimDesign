<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Phil Chalmers">

<title>Type I error rates and Power rate estimates</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="02-TypeI_and_Power_simulation_files/libs/clipboard/clipboard.min.js"></script>
<script src="02-TypeI_and_Power_simulation_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="02-TypeI_and_Power_simulation_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="02-TypeI_and_Power_simulation_files/libs/quarto-html/popper.min.js"></script>
<script src="02-TypeI_and_Power_simulation_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="02-TypeI_and_Power_simulation_files/libs/quarto-html/anchor.min.js"></script>
<link href="02-TypeI_and_Power_simulation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02-TypeI_and_Power_simulation_files/libs/quarto-html/quarto-syntax-highlighting-fe31d7bd2deb2a321418d01dba375a64.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="02-TypeI_and_Power_simulation_files/libs/quarto-html/quarto-syntax-highlighting-dark-f22e6b1ee40b1f8b08691e31e3ed3812.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="02-TypeI_and_Power_simulation_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="02-TypeI_and_Power_simulation_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="02-TypeI_and_Power_simulation_files/libs/bootstrap/bootstrap-9da755a953bcc7a1da2a0997e2be6de7.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="02-TypeI_and_Power_simulation_files/libs/bootstrap/bootstrap-dark-97673b6a6603f454becd47ddaaa96e03.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-dark"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    window.setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      window.setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    window.hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(darkModeDefault) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const darkModeDefault = true;
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !window.hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
    };
    // Switch to dark mode if need be
    if (window.hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#step1-1-define-conditions" id="toc-step1-1-define-conditions" class="nav-link active" data-scroll-target="#step1-1-define-conditions">Step1 1: Define conditions</a></li>
  <li><a href="#step-2-define-the-functions" id="toc-step-2-define-the-functions" class="nav-link" data-scroll-target="#step-2-define-the-functions">Step 2: Define the functions</a></li>
  <li><a href="#step-3-run-the-simulation" id="toc-step-3-run-the-simulation" class="nav-link" data-scroll-target="#step-3-run-the-simulation">Step 3: Run the simulation</a>
  <ul class="collapse">
  <li><a href="#analyse-the-results" id="toc-analyse-the-results" class="nav-link" data-scroll-target="#analyse-the-results">Analyse the results</a></li>
  </ul></li>
  <li><a href="#an-alternative-approach" id="toc-an-alternative-approach" class="nav-link" data-scroll-target="#an-alternative-approach">An alternative approach</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Type I error rates and Power rate estimates</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Phil Chalmers </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Determine the Type I error and Power rates for a t-test when different groups sizes are used. The independent t-test has three main assumptions:</p>
<ul>
<li>independence of observations,</li>
<li>the sampling distribution of the mean difference statistic is normal (which necessarily occurs when the data within the respective groups are normally distributed, but also will asymptotically occur as <span class="math inline">\(N\rightarrow\infty\)</span> because of the central limit theorem), and</li>
<li>homogeneity of variance.</li>
</ul>
<p>The Welch test, on the other hand, only requires the first two assumptions. In the simulation below, we will also explore how robust the independent t-test is to this violation, and compare how well the Welch test behaves under the same conditions.</p>
<section id="post-hoc-power-analysis" class="level4">
<h4 class="anchored" data-anchor-id="post-hoc-power-analysis">Post-hoc Power Analysis</h4>
<p>As an aside, while following simulation explores the empirical Type I and power rates, the same logic can be used to evaluate so-called <strong>post-hoc power analyses</strong> in empirical research. In this specific application only the power results would be obtained given some fixed sample size (the sample size used in the original research), population effect size(s), assumed random variable distributions, and <span class="math inline">\(\alpha\)</span> cut-off to obtain the empirical estimate of the power, <span class="math inline">\(1-\beta\)</span>. This is primarily useful in evaluating whether or not a published statistical test had a fair chance of rejecting an incorrect null hypothesis.</p>
<p>Alternatively, substituting in <em>estimates</em> of the associated effect size from a research study, however, will result in (highly-questionable) estimates of <strong>observed power</strong>. In general, observed power is of little use in applied research as it conflates population generating parameters with sub-optimal empirical estimates of said parameters, which can be particularly problematic in smaller samples size when the difference between the parameter and associated parameter estimate is large.</p>
</section>
<section id="step1-1-define-conditions" class="level2">
<h2 class="anchored" data-anchor-id="step1-1-define-conditions">Step1 1: Define conditions</h2>
<p>First, define the condition combinations that should be investigated. In this case we know that the size and ratio of the sample sizes within each group, as well as the respective group standard deviations, will influence the detection rates of the independent t-test. Here we study define three different sample sizes and standard deviations, and investigate their effect when completely crossed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SimDesign)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># SimFunctions()</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Design <span class="ot">&lt;-</span> <span class="fu">createDesign</span>(<span class="at">sample_size =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>, <span class="dv">120</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group_size_ratio =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">standard_deviation_ratio =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">8</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mean_difference =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Design)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 72  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Design, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  sample_size group_size_ratio standard_deviation_ratio mean_difference
        &lt;dbl&gt;            &lt;dbl&gt;                    &lt;dbl&gt;           &lt;dbl&gt;
1          30              0.5                        1               0
2          60              0.5                        1               0
3          90              0.5                        1               0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(Design, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  sample_size group_size_ratio standard_deviation_ratio mean_difference
        &lt;dbl&gt;            &lt;dbl&gt;                    &lt;dbl&gt;           &lt;dbl&gt;
1          60                2                        8             0.5
2          90                2                        8             0.5
3         120                2                        8             0.5</code></pre>
</div>
</div>
<p>Each row in <code>Design</code> represents a unique condition to be studied in the simulation. In this case, the first condition to be studied comes from row 1, where the total sample size is <span class="math inline">\(N=30\)</span>, and the ratio of sample sizes within each group is different. In this case, the second group is half (0.5) the size of the first group, therefore <span class="math inline">\(N1 = 20\)</span> and <span class="math inline">\(N2 = 10\)</span>. The standard deviation ratio is in this case 1 (i.e., they are exactly equal), and there is no mean difference between the groups. Analyzing rows with no mean difference will give us an idea of how the Type I error rates behave.</p>
<p>The last condition on row 72 indicates that the second group has a sample size twice as large as the first, and here <span class="math inline">\(N1 = 40\)</span> and <span class="math inline">\(N2 = 80\)</span>. As well, group 2 has a standard deviation which is 8 times larger than the first group, and overall there is a mean difference of 0.5 (i.e., a power condition). Truth be told, however, the interpretations could be switched around as it really depends on how the <code>Generate()</code> function utilizes these inputs (the interpretation could have been that group 1 was <em>smaller</em> when <code>group_size_ratio == .5</code> rather than larger).</p>
</section>
<section id="step-2-define-the-functions" class="level2">
<h2 class="anchored" data-anchor-id="step-2-define-the-functions">Step 2: Define the functions</h2>
<p>Begin by defining a data generation function for returning a <code>data.frame</code> with two columns: the dependent variable, and a grouping variable (a <code>factor</code> or otherwise).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Generate <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, <span class="at">fixed_objects =</span> <span class="cn">NULL</span>){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Attach</span>(condition) <span class="co"># makes all elements in condition available</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(group_size_ratio <span class="sc">&lt;</span> <span class="dv">1</span>){</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        N2 <span class="ot">&lt;-</span> sample_size <span class="sc">/</span> (<span class="dv">1</span><span class="sc">/</span>group_size_ratio <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        N1 <span class="ot">&lt;-</span> sample_size <span class="sc">-</span> N2</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        N1 <span class="ot">&lt;-</span> sample_size <span class="sc">/</span> (group_size_ratio <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        N2 <span class="ot">&lt;-</span> sample_size <span class="sc">-</span> N1</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    group1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N1)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    group2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N2, <span class="at">mean=</span>mean_difference, <span class="at">sd=</span>standard_deviation_ratio)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">'g1'</span>, N1), <span class="fu">rep</span>(<span class="st">'g2'</span>, N2)), <span class="at">DV =</span> <span class="fu">c</span>(group1, group2))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    dat</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>Generate()</code> function defined above first extracts the elements from <code>condition</code> for convenience, generates data for two groups using random normal draws, and returns a data.frame object containing the dependent variable and grouping information.</p>
<p><em>NOTE</em>: if you are using RStudio with diagnostic flags on then use of <code>Attach()</code> will result in false positive ‘missing’ variables as the IDE does not track the appropriate variable names (hence, you’ll see yellow caution variables). To fix these false positives without disabling such potentially useful diagnostic simply copy and paste the following output somewhere into your R script to suppress these messages only for specific variables rather than all variables in the analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Attach</span>(Design, <span class="at">RStudio_flags =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># !diagnostics suppress=sample_size,group_size_ratio,standard_deviation_ratio,mean_difference</code></pre>
</div>
</div>
<p>Continuing with the example, the <code>Analyse()</code> definition below performs a Welch and independent <span class="math inline">\(t\)</span>-test on the data generated from <code>Generate()</code>, checks whether any errors occurred during the calls to the estimation functions, and extracts and returns the respective <span class="math inline">\(p\)</span>-values for each statistical analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Analyse <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, dat, <span class="at">fixed_objects =</span> <span class="cn">NULL</span>){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    welch <span class="ot">&lt;-</span> <span class="fu">t.test</span>(DV <span class="sc">~</span> group, dat)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    ind <span class="ot">&lt;-</span> <span class="fu">t.test</span>(DV <span class="sc">~</span> group, dat, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    ret <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">welch=</span>welch<span class="sc">$</span>p.value, <span class="at">independent=</span>ind<span class="sc">$</span>p.value)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    ret</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, after the number of replications defined in <code>replications</code> has been completed, a matrix (or list, if the output of <code>Analyse()</code> were a list instead of a vector) containing the overall results should be summerised into suitable meta-descriptions of the behaviour. This is accomplished with the <code>Summarise()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Summarise <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, results, <span class="at">fixed_objects =</span> <span class="cn">NULL</span>){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    ret <span class="ot">&lt;-</span> <span class="fu">EDR</span>(results, <span class="at">alpha =</span> .<span class="dv">05</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    ret</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the above function, the <code>results</code> input is a matrix of size <code>replications</code> by 2 containing the respective <span class="math inline">\(p\)</span>-values returned from <code>Analyse()</code> across the desired number of replications. It is here where empirical detection rates can be determined, where the convenience function <code>EDR()</code> is available for just this purpose. Each column in the supplied matrix of <span class="math inline">\(p\)</span>-values is checked to determine whether it is less that <span class="math inline">\(\alpha = .05\)</span>, and the average number of times this occurs is returned as a vector of length 2 with the column names associated. Note that names are preserved in the <code>EDR()</code> function, therefore it is clear which element represents the Welch and Independent t-test rates.</p>
</section>
<section id="step-3-run-the-simulation" class="level2">
<h2 class="anchored" data-anchor-id="step-3-run-the-simulation">Step 3: Run the simulation</h2>
<p>In this case a few extra arguments are passed to <code>runSimulation()</code>. To help speed things up, the use of parallel architecture is used by passing <code>parallel = TRUE</code>, and messages printed to the console are disabled by passing <code>verbose = FALSE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">runSimulation</span>(<span class="at">design =</span> Design, <span class="at">replications =</span> <span class="dv">1000</span>, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">generate =</span> Generate, <span class="at">analyse =</span> Analyse, <span class="at">summarise =</span> Summarise,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="analyse-the-results" class="level3">
<h3 class="anchored" data-anchor-id="analyse-the-results">Analyse the results</h3>
<p>Usually it is a good idea to split up analyses into Type I error and power rates data, and to make <code>design</code> conditions into <code>factor</code>s if/where necessary. More specifically, Power rates really should only be interpreted when the Type I errors are well behaved (liberal detection rates naturally will result in more powerful tests, while conservative detection rates will induce lower power).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 10
   sample_size group_size_ratio standard_deviation_ratio mean_difference welch
         &lt;dbl&gt;            &lt;dbl&gt;                    &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt;
 1          30              0.5                        1               0 0.042
 2          60              0.5                        1               0 0.051
 3          90              0.5                        1               0 0.05 
 4         120              0.5                        1               0 0.051
 5          30              1                          1               0 0.053
 6          60              1                          1               0 0.05 
 7          90              1                          1               0 0.051
 8         120              1                          1               0 0.052
 9          30              2                          1               0 0.053
10          60              2                          1               0 0.051
# ℹ 62 more rows
# ℹ 5 more variables: independent &lt;dbl&gt;, REPLICATIONS &lt;dbl&gt;, SIM_TIME &lt;chr&gt;,
#   SEED &lt;int&gt;, COMPLETED &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(TypeI <span class="ot">&lt;-</span> <span class="fu">subset</span>(res, mean_difference <span class="sc">==</span> <span class="dv">0</span>, <span class="at">select=</span>sample_size<span class="sc">:</span>independent))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 6
   sample_size group_size_ratio standard_deviation_ratio mean_difference welch
         &lt;dbl&gt;            &lt;dbl&gt;                    &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt;
 1          30              0.5                        1               0 0.042
 2          60              0.5                        1               0 0.051
 3          90              0.5                        1               0 0.05 
 4         120              0.5                        1               0 0.051
 5          30              1                          1               0 0.053
 6          60              1                          1               0 0.05 
 7          90              1                          1               0 0.051
 8         120              1                          1               0 0.052
 9          30              2                          1               0 0.053
10          60              2                          1               0 0.051
# ℹ 26 more rows
# ℹ 1 more variable: independent &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(Power <span class="ot">&lt;-</span> <span class="fu">subset</span>(res, mean_difference <span class="sc">!=</span> <span class="dv">0</span>, <span class="at">select=</span>sample_size<span class="sc">:</span>independent))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 6
   sample_size group_size_ratio standard_deviation_ratio mean_difference welch
         &lt;dbl&gt;            &lt;dbl&gt;                    &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt;
 1          30              0.5                        1             0.5 0.21 
 2          60              0.5                        1             0.5 0.411
 3          90              0.5                        1             0.5 0.577
 4         120              0.5                        1             0.5 0.726
 5          30              1                          1             0.5 0.274
 6          60              1                          1             0.5 0.47 
 7          90              1                          1             0.5 0.649
 8         120              1                          1             0.5 0.797
 9          30              2                          1             0.5 0.239
10          60              2                          1             0.5 0.443
# ℹ 26 more rows
# ℹ 1 more variable: independent &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Lets start off by looking at some descriptive tables, and performing simple ANOVA analyses with effect sizes to determine where the differences generally occurred.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>mlt <span class="ot">&lt;-</span> <span class="fu">melt</span>(TypeI, <span class="at">id.vars =</span> <span class="fu">colnames</span>(TypeI)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">dcast</span>(mlt, group_size_ratio <span class="sc">+</span> standard_deviation_ratio <span class="sc">+</span> sample_size <span class="sc">~</span> variable)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(out) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Group Ratio'</span>, <span class="st">'SD Ratio'</span>, <span class="st">'N'</span>, <span class="st">'Welch'</span>, <span class="st">'Independent'</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>emph <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">which</span>(out <span class="sc">&gt;</span> .<span class="dv">075</span> <span class="sc">|</span> out <span class="sc">&lt;</span> .<span class="dv">025</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(out, <span class="at">round=</span><span class="dv">2</span>, <span class="at">emphasize.strong.cells =</span> emph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 15%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Group Ratio</th>
<th style="text-align: center;">SD Ratio</th>
<th style="text-align: center;">N</th>
<th style="text-align: center;">Welch</th>
<th style="text-align: center;">Independent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>30</strong></td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>60</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>90</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>120</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;"><strong>30</strong></td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;"><strong>0.16</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;"><strong>60</strong></td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;"><strong>0.18</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;"><strong>90</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"><strong>0.16</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;"><strong>120</strong></td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;"><strong>0.16</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>30</strong></td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;"><strong>0.17</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>60</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"><strong>0.14</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>90</strong></td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;"><strong>0.18</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>120</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"><strong>0.17</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>30</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>60</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>90</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>120</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;"><strong>30</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;"><strong>60</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;"><strong>90</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;"><strong>120</strong></td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>30</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>60</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.06</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>90</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>120</strong></td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>30</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>60</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>90</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>120</strong></td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;"><strong>30</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"><strong>0.01</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;"><strong>60</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"><strong>0.01</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;"><strong>90</strong></td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;"><strong>0.01</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;"><strong>120</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"><strong>0.01</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>30</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"><strong>0.01</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>60</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"><strong>0</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>90</strong></td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;"><strong>0.01</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>120</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"><strong>0.01</strong></td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>out2 <span class="ot">&lt;-</span> <span class="fu">dcast</span>(mlt, group_size_ratio <span class="sc">+</span> standard_deviation_ratio <span class="sc">~</span> variable, <span class="at">fun.aggregate =</span> mean)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(out2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Group Ratio'</span>, <span class="st">'SD Ratio'</span>, <span class="st">'Welch'</span>, <span class="st">'Independent'</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>emph2 <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">which</span>(out2 <span class="sc">&gt;</span> .<span class="dv">075</span> <span class="sc">|</span> out2 <span class="sc">&lt;</span> .<span class="dv">025</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(out2, <span class="at">round=</span><span class="dv">2</span>, <span class="at">emphasize.strong.cells =</span> emph2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 15%">
<col style="width: 11%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Group Ratio</th>
<th style="text-align: center;">SD Ratio</th>
<th style="text-align: center;">Welch</th>
<th style="text-align: center;">Independent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;"><strong>0.17</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>0.5</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"><strong>0.16</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"><strong>0.01</strong></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;"><strong>0.01</strong></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The descriptive results of the rates seem to be very favorable for the Welch test in that they are all close to the nominal detection rate. However, the independent <span class="math inline">\(t\)</span>-test appears to have combinations where it is either liberal or conservative. Though we could simply inspect the table to see why/where this occurred, sometimes it is easier to use ANOVAs to help pinpoint where the sources of variation occurred.</p>
<p>The one catch with ANOVAs is that there must be within-group variability, therefore something in our design must be marginalized. In this case, we will marginalize sample size because Type I error rates really shouldn’t be influenced by <span class="math inline">\(N\)</span>. Inspecting the previous table as also indicates that this assumption is probably a good one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">SimAnova</span>(independent <span class="sc">~</span> sample_size, TypeI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                SS df    MS     F     p sig eta.sq eta.sq.part
sample_size  0.097  1 0.097 0.076 0.784   .  0.002       0.002
Residuals   43.265 34 1.272    NA    NA      0.998          NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">SimAnova</span>(independent <span class="sc">~</span> group_size_ratio <span class="sc">*</span> standard_deviation_ratio, TypeI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                              SS df     MS      F     p sig
group_size_ratio                          28.673  1 28.673 254.12 0.000 ***
standard_deviation_ratio                   0.331  1  0.331   2.94 0.096   .
group_size_ratio:standard_deviation_ratio 10.746  1 10.746  95.24 0.000 ***
Residuals                                  3.611 32  0.113     NA    NA    
                                          eta.sq eta.sq.part
group_size_ratio                           0.661       0.888
standard_deviation_ratio                   0.008       0.084
group_size_ratio:standard_deviation_ratio  0.248       0.749
Residuals                                  0.083          NA</code></pre>
</div>
</div>
<p>After examining the effect sizes for the independent t-test, there appears to be an interaction effect between <code>group_size_ratio</code> and <code>standard_deviation_ratio</code>. To help visualize this effect, we create box-plots while continuing to marginalize over the sample size (otherwise, we would have to use point estimates for scatter plots).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">SimAnova</span>(welch <span class="sc">~</span> group_size_ratio <span class="sc">*</span> standard_deviation_ratio, TypeI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                             SS df    MS     F     p sig eta.sq
group_size_ratio                          0.034  1 0.034 2.328 0.137   .  0.068
standard_deviation_ratio                  0.000  1 0.000 0.006 0.940   .  0.000
group_size_ratio:standard_deviation_ratio 0.001  1 0.001 0.094 0.761   .  0.003
Residuals                                 0.467 32 0.015    NA    NA      0.929
                                          eta.sq.part
group_size_ratio                                0.068
standard_deviation_ratio                        0.000
group_size_ratio:standard_deviation_ratio       0.003
Residuals                                          NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Welch</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(TypeI, <span class="fu">aes</span>(<span class="fu">factor</span>(group_size_ratio), welch, <span class="at">fill =</span> <span class="fu">factor</span>(standard_deviation_ratio)))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>gg <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>standard_deviation_ratio) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">075</span>, <span class="at">colour =</span> <span class="st">'red'</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">025</span>, <span class="at">colour =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-TypeI_and_Power_simulation_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Independent</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(TypeI, <span class="fu">aes</span>(<span class="fu">factor</span>(group_size_ratio), independent, <span class="at">fill =</span> <span class="fu">factor</span>(standard_deviation_ratio)))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>gg <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>standard_deviation_ratio) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">075</span>, <span class="at">colour =</span> <span class="st">'red'</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">025</span>, <span class="at">colour =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-TypeI_and_Power_simulation_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What is immediately obvious from these figures is that the Welch test performs fairly well across all conditions for controlling Type I error rates, while the independent <span class="math inline">\(t\)</span>-test is heavily influenced by different combinations. When the variances were equal (left facet plot), the independent <span class="math inline">\(t\)</span>-test appeared to perform well, and this should not be surprising because all the assumptions were met. As well, when the sample sizes were equal the test seemed to perform well across the board.</p>
<p>However, when the second group contained a larger variance <strong>AND</strong> a larger sample size than the first group the detection rates became more conservative. The converse was true when larger variances were paired with smaller sample sizes compared to the first group, where the detection rates became progressively more liberal as both the ratio of sample sizes increase and the ratio of standard deviations increased.</p>
</section>
</section>
<section id="an-alternative-approach" class="level1">
<h1>An alternative approach</h1>
<p>The following is the same simulation design as above, however the approach is slightly different. Because the <code>design</code> input object is a <code>data.frame</code> object it is technically possible to include <code>list</code>s as factors as well to be passed to <code>createDesign()</code>, thereby creating a fully-crossed simulation design with the <code>list</code> inputs. This may be preferable to some users if, for example, you would rather explicitly include grouping distributions in <code>design</code> rather than using scalars like 1/2, 1, and 2.</p>
<p>Consider the following design definition:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SimDesign)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># SimFunctions()</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>Design <span class="ot">&lt;-</span> <span class="fu">createDesign</span>(<span class="at">sample_size =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>, <span class="dv">120</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group_sizes =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">c</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">standard_deviations =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                                               <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                                               <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>)),</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">means =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)))</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>Design</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 4
   sample_size group_sizes standard_deviations means    
         &lt;dbl&gt; &lt;list&gt;      &lt;list&gt;              &lt;list&gt;   
 1          30 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt;
 2          60 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt;
 3          90 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt;
 4         120 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt;
 5          30 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt;
 6          60 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt;
 7          90 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt;
 8         120 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt;
 9          30 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt;
10          60 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt;
# ℹ 62 more rows</code></pre>
</div>
</div>
<p>Notice that there are still 72 conditions to be investigated, however now each element in <code>Design$group_sizes</code>, <code>Design$standard_deviation</code>, and <code>Design$means</code> are vectors rather than a scalars. E.g.,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>Design[<span class="dv">1</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  sample_size group_sizes standard_deviations means    
        &lt;dbl&gt; &lt;list&gt;      &lt;list&gt;              &lt;list&gt;   
1          30 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>Design<span class="sc">$</span>group_sizes[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.333 0.667</code></pre>
</div>
</div>
<p>Hence, all elements are explicitly defined for each group rather than indexed and manipulated as in the previous example. The remainder of the simulation code is as follows (not that in this case only the <code>Generate()</code> function needed to be modified):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>Generate <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, <span class="at">fixed_objects =</span> <span class="cn">NULL</span>){</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">with</span>(condition, sample_size)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    Ns <span class="ot">&lt;-</span> N <span class="sc">*</span> <span class="fu">with</span>(condition, group_sizes[[<span class="dv">1</span>]])</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    N1 <span class="ot">&lt;-</span> Ns[<span class="dv">1</span>]; N2 <span class="ot">&lt;-</span> Ns[<span class="dv">2</span>]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    sd <span class="ot">&lt;-</span> <span class="fu">with</span>(condition, standard_deviations[[<span class="dv">1</span>]])</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">with</span>(condition, means[[<span class="dv">1</span>]])</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    group1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N1, <span class="at">mean=</span>m[<span class="dv">1</span>], <span class="at">sd=</span>sd[<span class="dv">1</span>])</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    group2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N2, <span class="at">mean=</span>m[<span class="dv">2</span>], <span class="at">sd=</span>sd[<span class="dv">2</span>])</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">'g1'</span>, N1), <span class="fu">rep</span>(<span class="st">'g2'</span>, N2)), <span class="at">DV =</span> <span class="fu">c</span>(group1, group2))</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    dat</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>Analyse <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, dat, <span class="at">fixed_objects =</span> <span class="cn">NULL</span>){</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    welch <span class="ot">&lt;-</span> <span class="fu">t.test</span>(DV <span class="sc">~</span> group, dat)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    ind <span class="ot">&lt;-</span> <span class="fu">t.test</span>(DV <span class="sc">~</span> group, dat, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    ret <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">welch=</span>welch<span class="sc">$</span>p.value, <span class="at">independent=</span>ind<span class="sc">$</span>p.value)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    ret</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>Summarise <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, results, <span class="at">fixed_objects =</span> <span class="cn">NULL</span>){</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    ret <span class="ot">&lt;-</span> <span class="fu">EDR</span>(results, <span class="at">alpha =</span> .<span class="dv">05</span>)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    ret</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------------------------------</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">runSimulation</span>(<span class="at">design =</span> Design, <span class="at">replications =</span> <span class="dv">1000</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">parallel=</span><span class="cn">TRUE</span>,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">generate =</span> Generate, <span class="at">analyse =</span> Analyse, <span class="at">summarise =</span> Summarise)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 10
   sample_size group_sizes standard_deviations means     welch independent
         &lt;dbl&gt; &lt;list&gt;      &lt;list&gt;              &lt;list&gt;    &lt;dbl&gt;       &lt;dbl&gt;
 1          30 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt; 0.048       0.047
 2          60 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt; 0.052       0.051
 3          90 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt; 0.041       0.044
 4         120 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt; 0.047       0.051
 5          30 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt; 0.046       0.046
 6          60 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt; 0.041       0.041
 7          90 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt; 0.049       0.049
 8         120 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt; 0.067       0.067
 9          30 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt; 0.052       0.061
10          60 &lt;dbl [2]&gt;   &lt;dbl [2]&gt;           &lt;dbl [2]&gt; 0.056       0.052
# ℹ 62 more rows
# ℹ 4 more variables: REPLICATIONS &lt;dbl&gt;, SIM_TIME &lt;chr&gt;, SEED &lt;int&gt;,
#   COMPLETED &lt;chr&gt;</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    window.setColorSchemeToggle(window.hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>