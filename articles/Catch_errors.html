<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Managing warning and error messages • SimDesign</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Managing warning and error messages">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar- navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SimDesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.20.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Catch_errors.html">Managing warning and error messages</a>
    </li>
    <li>
      <a href="../articles/Fixed_obj_fun.html">Exporting objects and functions from the workspace</a>
    </li>
    <li>
      <a href="../articles/HPC-computing.html">Distributing jobs for high-performance computing (HPC) clusters (e.g., via Slurm)</a>
    </li>
    <li>
      <a href="../articles/MultipleAnalyses.html">Multiple analysis functions</a>
    </li>
    <li>
      <a href="../articles/Parallel-computing.html">Parallel computing information</a>
    </li>
    <li>
      <a href="../articles/Saving-results.html">Saving simulation results and state</a>
    </li>
    <li>
      <a href="../articles/SimDesign-intro.html">Introduction to the SimDesign package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/philchalmers/SimDesign/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-sun"></span>


    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Light</li>
    <li class="dropdown-header">Dark</li>
    <li class="dropdown-header">Auto</li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Managing warning and error messages</h1>
                        <h4 data-toc-skip class="author">Phil
Chalmers</h4>
            
            <h4 data-toc-skip class="date">2025-08-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/SimDesign/blob/main/vignettes/Catch_errors.Rmd" class="external-link"><code>vignettes/Catch_errors.Rmd</code></a></small>
      <div class="hidden name"><code>Catch_errors.Rmd</code></div>

    </div>

    
    
<p>Error catching is an important area to consider when creating Monte
Carlo simulations. Sometimes, iterative algorithms will ‘fail to
converge’, or otherwise crash for other reasons (e.g., sparse data).
Moreover, errors may happen in unexpected combinations of the design
factors under investigation, which can lead to abrupt termination of a
simulation’s execution.</p>
<p><code>SimDesign</code> makes managing errors much easier because the
internal functions are automatically wrapped within <code>try</code>
blocks, and therefore simulations will not terminate unexpectedly. This
type of information is also collected in the final simulation object
since it may be relevant to the writer that something unknown is going
wrong in the code-base. Below we demonstrate what happens when errors
are thrown and caught, and how this information is tracked in the
returned object.</p>
<div class="section level2">
<h2 id="define-the-functions">Define the functions<a class="anchor" aria-label="anchor" href="#define-the-functions"></a>
</h2>
<p>As usual, define the functions of interest.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://philchalmers.github.io/SimDesign/">SimDesign</a></span><span class="op">)</span></span>
<span><span class="co"># SimFunctions(comments=FALSE)</span></span>
<span></span>
<span><span class="va">Design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDesign.html">createDesign</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Generate</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">condition</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ret</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">Analyse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">dat</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">whc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.7</span>, <span class="fl">.20</span>, <span class="fl">.05</span>, <span class="fl">.05</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">whc</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>       <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">whc</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># missing arguments</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">whc</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="st">'invalid'</span><span class="op">)</span> <span class="co"># invalid arguments</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">whc</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="co"># throw error manually </span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">'Manual error thrown'</span><span class="op">)</span> </span>
<span>    <span class="op">}</span></span>
<span>    <span class="co"># manual warnings</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.9</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">'This warning happens rarely'</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">'This warning happens much more often'</span><span class="op">)</span></span>
<span>    <span class="va">ret</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">Summarise</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">results</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>bias <span class="op">=</span> <span class="fu"><a href="../reference/bias.html">bias</a></span><span class="op">(</span><span class="va">results</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ret</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The above simulation is just an example of how errors are tracked in
<code>SimDesign</code>, as well as how to throw a manual error in case
the data should be re-drawn based on the user’s decision (e.g., when a
model converges, but fails to do so before some number of predefined
iterations).</p>
</div>
<div class="section level2">
<h2 id="run-the-simulation">Run the simulation<a class="anchor" aria-label="anchor" href="#run-the-simulation"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runSimulation.html">runSimulation</a></span><span class="op">(</span><span class="va">Design</span>, replications <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                       generate<span class="op">=</span><span class="va">Generate</span>, analyse<span class="op">=</span><span class="va">Analyse</span>, summarise<span class="op">=</span><span class="va">Summarise</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Design: 1/3;   Replications: 100;   RAM Used: 69.6 Mb;   Total Time: 0.00s </span></span>
<span><span class="co">##  Conditions: N=10</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Design: 2/3;   Replications: 100;   RAM Used: 70.8 Mb;   Total Time: 0.05s </span></span>
<span><span class="co">##  Conditions: N=20</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Design: 3/3;   Replications: 100;   RAM Used: 70.9 Mb;   Total Time: 0.10s </span></span>
<span><span class="co">##  Conditions: N=30</span></span>
<span><span class="co">## </span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 9</span></span></span>
<span><span class="co">##       N     bias REPLICATIONS SIM_TIME RAM_USED       SEED COMPLETED      ERRORS</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>    10 0.061<span style="text-decoration: underline;">138</span>          100 0.05s    70.8 Mb  <span style="text-decoration: underline;">1</span>140<span style="text-decoration: underline;">350</span>788 Wed Aug  6 13…     53</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>    20 0.014<span style="text-decoration: underline;">295</span>          100 0.05s    70.9 Mb   312<span style="text-decoration: underline;">928</span>385 Wed Aug  6 13…     52</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>    30 0.017<span style="text-decoration: underline;">927</span>          100 0.04s    71 Mb     866<span style="text-decoration: underline;">248</span>189 Wed Aug  6 13…     42</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: WARNINGS &lt;int&gt;</span></span></span></code></pre>
<p>What you’ll immediately notice from this output object is that counts
of the error and warning messages have been appended to the
<code>result</code> object. This is useful to determine just how
problematic the errors and warnings are based on their frequency alone.
Furthermore, the specific frequency in which the errors/warnings
occurred are also included for each design condition (here the
<code>t.test.default()</code> error, where no inputs were supplied,
occurred more often than the manually thrown error as well as the
invalid-input error) after extracting and inspecting
<code>SimExtract(results, what = 'errors')</code> and
<code>SimExtract(results, what = 'warnings')</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/SimExtract.html">SimExtract</a></span><span class="op">(</span><span class="va">result</span>, what <span class="op">=</span> <span class="st">'errors'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    N ERROR:  Error in t.test.default("invalid") : not enough 'x' observations\n</span></span>
<span><span class="co">## 1 10                                                                         12</span></span>
<span><span class="co">## 2 20                                                                          9</span></span>
<span><span class="co">## 3 30                                                                         10</span></span>
<span><span class="co">##   ERROR:  Error in t.test.default() : argument "x" is missing, with no default\n</span></span>
<span><span class="co">## 1                                                                             31</span></span>
<span><span class="co">## 2                                                                             38</span></span>
<span><span class="co">## 3                                                                             25</span></span>
<span><span class="co">##   ERROR:  Manual error thrown\n</span></span>
<span><span class="co">## 1                            10</span></span>
<span><span class="co">## 2                             5</span></span>
<span><span class="co">## 3                             7</span></span></code></pre>
<p>Finally, <code>SimDesign</code> has a built-in safety feature
controlled by with <code>max_errors</code> argument to avoid getting
stuck in infinite redrawing loops. By default, if more than 50 errors
are consecutively returned then the simulation condition will be halted,
and a warning message will be printed to the console indicating the last
observed fatal error. These safety features are built-in because too
many consecutive <code><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop()</a></code> calls generally indicates a major
problem in the simulation code which should be fixed before continuing.
However, when encountering fatal errors in a given simulation condition
the remainder of the simulation experiment will still be executed as
normal, where for the problematic conditions<code>NA</code> placeholders
will be assigned to these rows in the final output object. This is so
that the entire experiment does not unexpectedly terminate due to one or
more problematic row conditions in <code>Design</code>, and instead
these conditions can be inspected and debugged all at once at a later
time. Of course, if inspecting the code directly, the simulation could
be manually halted so that these terminal errors can be attended to
immediately (e.g., using <code>Ctrl + c</code>, or clicking the ‘Stop’
icon in Rstudio).</p>
</div>
<div class="section level2">
<h2 id="what-to-do-explicit-debugging">What to do (explicit debugging)<a class="anchor" aria-label="anchor" href="#what-to-do-explicit-debugging"></a>
</h2>
<p>If errors occur too often (but not in a fatal way) then the
respective design conditions should either be extracted out of the
simulation or further inspected to determine if they can be fixed (e.g.,
providing better starting values, increasing convergence criteria/number
of iterations, etc). For instance, say that the fourth row of the
<code>design</code> object raised a number of error messages that should
be inspected further. One useful approach then would be to debug the 4th
row on the instance that an error is raised, which can be achieved using
the following:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/runSimulation.html">runSimulation</a></span><span class="op">(</span><span class="va">...</span>, debug <span class="op">=</span> <span class="st">'error-4'</span><span class="op">)</span></span></code></pre></div>
<p>The <code>error</code> flag is used to enter R’s debugger on the
first instance of an error, while the <code>-4</code> indicates that
only the 4th row of <code>design</code> should be evaluated. This is
also one instance where changing warning messages into error messages
(i.e.,
<code>runSimulation(..., extra_options = list(warnings_as_errors=TRUE))</code>)
is particularly useful so that the state that generated a warning can be
inspected directly. Note that similar arguments can be made for
explicitly debugging functions in the generate-analyse-summarise chain
(e.g., <code>debug = 'analyse-4'</code>), though these are less useful
for debugging (more useful for initial code design).</p>
<div class="section level3">
<h3 id="manual-debugging-via-try">Manual debugging via <code>try()</code><a class="anchor" aria-label="anchor" href="#manual-debugging-via-try"></a>
</h3>
<p>Failing the above approach, manually wrapping the problematic
functions in a <code><a href="https://rdrr.io/r/base/try.html" class="external-link">try()</a></code> call. Adding the line
<code>if(is(object, 'try-error')) browser()</code> will jump into the
location/replication where the object unexpectedly witnessed, though
admittedly this is more clunky approach than using <code>debug</code>.
Nevertheless, jumping into the exact location where the error occurred,
particularly in the case where an <code>analyse()</code> function is
throwing multiple error messages, will greatly help you determine what
exactly went wrong in the simulation state, allowing you to quickly
locate and fix the issue.</p>
</div>
<div class="section level3">
<h3 id="extracting-error-seeds-for-hard-to-find-bugs">Extracting error seeds for hard-to-find bugs<a class="anchor" aria-label="anchor" href="#extracting-error-seeds-for-hard-to-find-bugs"></a>
</h3>
<p>An alternative approach to locating errors in general is to use
information stored within the <code>SimDesign</code> objects at the time
of completion. By default, all <code>.Random.seed</code> states
associated with errors are stored within the final object, and these can
be extracted using the <code>SimExtract(..., what='error_seeds')</code>
option. This function returns a <code>data.frame</code> object with each
seed stored column-wise, where the associated error message is contained
in the column name itself (and allowed to be coerced into a valid column
name to make it easier to use the <code>$</code> operator). For
example,</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seeds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SimExtract.html">SimExtract</a></span><span class="op">(</span><span class="va">result</span>, what <span class="op">=</span> <span class="st">'error_seeds'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">seeds</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">##   Design_row_1.1..Error.in.t.tes…¹ Design_row_1.2..Manu…² Design_row_1.3..Erro…³</span></span>
<span><span class="co">##                              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>                            <span style="text-decoration: underline;">10</span>403                  <span style="text-decoration: underline;">10</span>403                  <span style="text-decoration: underline;">10</span>403</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>                              624                     21                     65</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>                       -<span style="color: #BB0000;">159</span><span style="color: #BB0000; text-decoration: underline;">038</span><span style="color: #BB0000;">368</span>             -<span style="color: #BB0000;">230</span><span style="color: #BB0000; text-decoration: underline;">613</span><span style="color: #BB0000;">222</span>             -<span style="color: #BB0000;">230</span><span style="color: #BB0000; text-decoration: underline;">613</span><span style="color: #BB0000;">222</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>                       <span style="text-decoration: underline;">1</span>905<span style="text-decoration: underline;">303</span>777              203<span style="text-decoration: underline;">707</span>493              203<span style="text-decoration: underline;">707</span>493</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>                       -<span style="color: #BB0000;">371</span><span style="color: #BB0000; text-decoration: underline;">375</span><span style="color: #BB0000;">826</span>             <span style="text-decoration: underline;">1</span>161<span style="text-decoration: underline;">141</span>503             <span style="text-decoration: underline;">1</span>161<span style="text-decoration: underline;">141</span>503</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>                      -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">012</span><span style="color: #BB0000; text-decoration: underline;">234</span><span style="color: #BB0000;">281</span>              549<span style="text-decoration: underline;">195</span>142              549<span style="text-decoration: underline;">195</span>142</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ abbreviated names:</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ¹​Design_row_1.1..Error.in.t.test.default.....argument..x..is.missing..with.no.default.,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ²​Design_row_1.2..Manual.error.thrown.,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ³​Design_row_1.3..Error.in.t.test.default.....argument..x..is.missing..with.no.default.</span></span></span></code></pre>
<p>Given these seeds, replicating an exact error can be achieved by a)
extracting a single column into an <code>integer</code> vector, and b)
passing this vector to the <code>load_seed</code> input. For example,
replicating the first error message can be achieved as follows, where it
makes the most sense to immediately go into the debugging mode via the
<code>debug</code> inputs.</p>
<p><strong>Note</strong>: It is important to manually select the correct
<code>Design</code> row using this error extraction approach; otherwise,
the seed will clearly not replicate the exact problem state.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">picked_seed</span> <span class="op">&lt;-</span> <span class="va">seeds</span><span class="op">$</span><span class="va">Design_row_1.1..Error.in.t.test.default..invalid.....not.enough..x..observations.</span></span>
<span></span>
<span><span class="co"># debug analyse() for first row of Design object via debug='analyse-1'</span></span>
<span><span class="fu"><a href="../reference/runSimulation.html">runSimulation</a></span><span class="op">(</span><span class="va">Design</span>, replications <span class="op">=</span> <span class="fl">100</span>, load_seed<span class="op">=</span><span class="va">picked_seed</span>, debug<span class="op">=</span><span class="st">'analyse-1'</span>,</span>
<span>              generate<span class="op">=</span><span class="va">Generate</span>, analyse<span class="op">=</span><span class="va">Analyse</span>, summarise<span class="op">=</span><span class="va">Summarise</span><span class="op">)</span></span></code></pre></div>
<p>The <code>.Random.seed</code> state will be loaded at this exact
state, and will always be repeated at this state as well (in case
<code>c</code> is typed in the debugger, or somehow the error is harder
to find while walking through the debug mode). Hence, users must type
<code>Q</code> to exit the debugger after they have better understood
the nature of the error message first-hand, after which the
<code>load_seed</code> input should be removed.</p>
</div>
</div>
<div class="section level2">
<h2 id="converting-warings-to-errors-explicitly-via-managewarnings">Converting warings to errors explicitly via
<code>manageWarnings()</code><a class="anchor" aria-label="anchor" href="#converting-warings-to-errors-explicitly-via-managewarnings"></a>
</h2>
<p>On occasion functions will return <code>warning</code> message that
either border on (or should be treated as) error messages if they
influence the veracity of the simulation results. Such examples may
include models that appear to ‘converge’ but do so with non-nonsensical
parameter estimates (e.g., negative variances, non-positive definite
correlation matrices, maximum iterations reached in an numerical
searching algorithm, etc). However, because such issues are non-fatal
third-party software (i.e., functions not written by the developer of
the simulation) may simply raise a <code>warning</code> message for
further inspection, whereas in a Monte Carlo simulation experiment such
issues should generally be treated as invalid (though their frequency of
occurrence should still be tracked, as is the default in
<code>SimDesign</code>).</p>
<p>To resolve this issue, and to avoid using a more nuclear option such
as setting <code>option(warn=2)</code> to treat <em>all</em> warnings as
errors in the simulation, the function <code><a href="../reference/manageWarnings.html">manageWarnings()</a></code> can
be used to explicit convert known warning message strings into errors
that disrupt the code execution while allowing other warning messages to
continue to be raised.</p>
<p>For example, if a function utilized in a simulation was</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myfun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.9</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">'This warning is serious'</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">'This warning is no big deal'</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">myfun</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">myfun</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in myfun(): This warning is no big deal</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">myfun</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in myfun(): This warning is serious</span></span></code></pre>
<p>then whenever the serious warning message is raised it could be
explicitly converted to an error using an internal <code><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl()</a></code>
test.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">out1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manageWarnings.html">manageWarnings</a></span><span class="op">(</span><span class="fu">myfun</span><span class="op">(</span><span class="op">)</span>, </span>
<span>                        warning2error<span class="op">=</span><span class="st">'This warning is serious'</span><span class="op">)</span></span>
<span><span class="va">out1</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manageWarnings.html">manageWarnings</a></span><span class="op">(</span><span class="fu">myfun</span><span class="op">(</span><span class="op">)</span>, </span>
<span>                        warning2error<span class="op">=</span><span class="st">'This warning is serious'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in myfun(): This warning is no big deal</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out2</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">out3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manageWarnings.html">manageWarnings</a></span><span class="op">(</span><span class="fu">myfun</span><span class="op">(</span><span class="op">)</span>, </span>
<span>                        warning2error<span class="op">=</span><span class="st">'This warning is serious'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error: This warning is serious</span></span></code></pre>
<p>which now converts the previous warning message into an error
message, thereby correctly disrupting the flow of the Monte Carlo
simulation experiment and prompting a new call to
<code><a href="../reference/Generate.html">Generate()</a></code>. Of course, all warning and error messages are
tallied in the resulting <code><a href="../reference/runSimulation.html">runSimulation()</a></code> object, though now
the serious warnings will be tallied as disruptive errors instead of
warnings that continued normally.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
