<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multiple analysis functions â€¢ SimDesign</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Multiple analysis functions">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar- navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SimDesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.20.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Catch_errors.html">Managing warning and error messages</a>
    </li>
    <li>
      <a href="../articles/Fixed_obj_fun.html">Exporting objects and functions from the workspace</a>
    </li>
    <li>
      <a href="../articles/HPC-computing.html">Distributing jobs for high-performance computing (HPC) clusters (e.g., via Slurm)</a>
    </li>
    <li>
      <a href="../articles/MultipleAnalyses.html">Multiple analysis functions</a>
    </li>
    <li>
      <a href="../articles/Parallel-computing.html">Parallel computing information</a>
    </li>
    <li>
      <a href="../articles/Saving-results.html">Saving simulation results and state</a>
    </li>
    <li>
      <a href="../articles/SimDesign-intro.html">Introduction to the SimDesign package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/philchalmers/SimDesign/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-sun"></span>


    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Light</li>
    <li class="dropdown-header">Dark</li>
    <li class="dropdown-header">Auto</li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Multiple analysis functions</h1>
                        <h4 data-toc-skip class="author">Phil
Chalmers</h4>
            
            <h4 data-toc-skip class="date">2025-08-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/SimDesign/blob/main/vignettes/MultipleAnalyses.Rmd" class="external-link"><code>vignettes/MultipleAnalyses.Rmd</code></a></small>
      <div class="hidden name"><code>MultipleAnalyses.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates one of the newer features in the
<code>SimDesign</code> package pertaining to multiple analysis function
definitions that can be selected for each <code>Design</code> condition
or whenever they are applicable. The purpose of providing multiple
analysis functions is to</p>
<ol style="list-style-type: decimal">
<li>Remove the less readable if-then-else combinations that can appear
when writing simulation code, where specific analysis functions are not
intended to be used on a given generated dataset,</li>
<li>Provide better automatic naming of the analysis results across
independent subroutines,</li>
<li>Construct more readable code when the <code><a href="../reference/Analyse.html">Analyse()</a></code>
function contains too much code to easily track, and to</li>
<li>Create a more modular approach to isolating the analysis functions
for the purpose of redistribution or reusing in related projects</li>
</ol>
<p>Functionality speaking, this type of organization does not change how
<code>SimDesign</code> generally operates. For that reason, the coding
style presented in this vignette can be considered optional. However, if
any of the above points resonate well with you then following the
details of this coding organization style may prove useful.</p>
<div class="section level2">
<h2 id="description-of-structure">Description of structure<a class="anchor" aria-label="anchor" href="#description-of-structure"></a>
</h2>
<p>The usual work-flow with <code>SimDesign</code> requires first
calling <code><a href="../reference/SimFunctions.html">SimFunctions()</a></code> to generate a working template, such
as the following.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">SimDesign</span><span class="fu">::</span><span class="fu"><a href="../reference/SimFunctions.html">SimFunctions</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## #-------------------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## library(SimDesign)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Design &lt;- createDesign(factor1 = NA,</span></span>
<span><span class="co">##                        factor2 = NA)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## #-------------------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Generate &lt;- function(condition, fixed_objects) {</span></span>
<span><span class="co">##     dat &lt;- data.frame()</span></span>
<span><span class="co">##     dat</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Analyse &lt;- function(condition, dat, fixed_objects) {</span></span>
<span><span class="co">##     ret &lt;- nc(stat1 = NaN, stat2 = NaN)</span></span>
<span><span class="co">##     ret</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summarise &lt;- function(condition, results, fixed_objects) {</span></span>
<span><span class="co">##     ret &lt;- c(bias = NaN, RMSE = NaN)</span></span>
<span><span class="co">##     ret</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## #-------------------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## res &lt;- runSimulation(design=Design, replications=2, generate=Generate, </span></span>
<span><span class="co">##                      analyse=Analyse, summarise=Summarise)</span></span>
<span><span class="co">## res</span></span></code></pre>
<p>which uses the default <code>nAnalyses=1</code> to generate only a
single <code><a href="../reference/Analyse.html">Analyse()</a></code> function. In the context of multiple
analysis functions, however, users may be more interested in passing the
number of analysis functions they believe they will need in their
simulation (e.g., if analyzing a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-test
setup to compare the Welch versus independent samples t-test, then two
analysis functions should be used). Passing <code>nAnalyses=2</code> to
<code><a href="../reference/SimFunctions.html">SimFunctions()</a></code> creates the following template:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">SimDesign</span><span class="fu">::</span><span class="fu"><a href="../reference/SimFunctions.html">SimFunctions</a></span><span class="op">(</span>nAnalyses <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## #-------------------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## library(SimDesign)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Design &lt;- createDesign(factor1 = NA,</span></span>
<span><span class="co">##                        factor2 = NA)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## #-------------------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Generate &lt;- function(condition, fixed_objects) {</span></span>
<span><span class="co">##     dat &lt;- data.frame()</span></span>
<span><span class="co">##     dat</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Analyse.A1 &lt;- function(condition, dat, fixed_objects) {</span></span>
<span><span class="co">##     ret &lt;- nc(stat1 = NaN, stat2 = NaN)</span></span>
<span><span class="co">##     ret</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Analyse.A2 &lt;- function(condition, dat, fixed_objects) {</span></span>
<span><span class="co">##     ret &lt;- nc(stat1 = NaN, stat2 = NaN)</span></span>
<span><span class="co">##     ret</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## #-------------------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summarise &lt;- function(condition, results, fixed_objects) {</span></span>
<span><span class="co">##     ret &lt;- c(bias = NaN, RMSE = NaN)</span></span>
<span><span class="co">##     ret</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## #-------------------------------------------------------------------</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## res &lt;- runSimulation(design=Design, replications=2,generate=Generate, </span></span>
<span><span class="co">##                      analyse=list(A1=Analyse.A1, A2=Analyse.A2), </span></span>
<span><span class="co">##                      summarise=Summarise)</span></span>
<span><span class="co">## res</span></span></code></pre>
<p>Notice in this case that there are two <code>Analyse.#()</code>
definitions constructed, and when passed to <code><a href="../reference/runSimulation.html">runSimulation()</a></code>
these are organized as a named <code>list</code>. The names of the list
will ultimately be attached to the names of the analysis objects so that
there is no ambiguity in the outputted information. However, the inputs
to the <code><a href="../reference/Analyse.html">Analyse()</a></code> functions will always be the same, as the
<code>dat</code> object formed by the <code><a href="../reference/Generate.html">Generate()</a></code> call will
be passed to each of these Analyse definitions (hence, the generate data
is held constant across the respective analyses).</p>
<p>The above template should of course be modified to replace the less
useful names of the <code>Analyse.#()</code> components. By default
users will want to change these to something like
<code>Analyse.some_statistic</code>,
<code>Analyse.some_other_statistic</code>, â€¦,
<code>Analyse.some_other_other_statistic</code>, and so on, where the
number of <code>Analyse.#</code> function definitions will ultimately
end up in the <code>runSimulation(..., Analyse=list())</code> input.
Supplying better names to the named <code>list</code> component is also
recommended as these will be used to name the associated results in the
<code><a href="../reference/Summarise.html">Summarise()</a></code> step.</p>
<p>Finally, note that all the rules about objects and object naming from
the typical single Analyse function still apply and are properly checked
internally for suitable names and consistency. The independently defined
Analyse functions are also <em>interchangable</em> and
<em>removable</em>/<em>replaceable</em>, which makes the structure of
the Generate-Analyse-Summarise setup more modular with respect to the
analysis components.</p>
<div class="section level3">
<h3 id="an-example">An example<a class="anchor" aria-label="anchor" href="#an-example"></a>
</h3>
<p>The following code is <a href="http://philchalmers.github.io/SimDesign/html/03-Parameter_recovery_simulation.html">adopted
from the Wiki</a>, and so details about the simulation should be
obtained from that source.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note that all attached packages are automatically exported in SimDesign</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://philchalmers.github.io/SimDesign/">SimDesign</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://philchalmers.github.io/mirt/" class="external-link">mirt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="co"># SimFunctions(nAnalyses = 2)</span></span>
<span></span>
<span><span class="va">sample_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">250</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">nitems</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">Design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDesign.html">createDesign</a></span><span class="op">(</span>sample_size <span class="op">=</span> <span class="va">sample_sizes</span>, </span>
<span>                       nitems <span class="op">=</span> <span class="va">nitems</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create list of additional parameters which are fixed across conditions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pars_10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">.3</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">/</span><span class="fl">1.702</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">/</span><span class="fl">1.702</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pars_20</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">.3</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">/</span><span class="fl">1.702</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">0</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">/</span><span class="fl">1.702</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ten<span class="op">=</span><span class="va">pars_10</span>, twenty<span class="op">=</span><span class="va">pars_20</span><span class="op">)</span></span>
<span></span>
<span><span class="va">P_logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">Theta</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">Theta</span> <span class="op">+</span> <span class="va">d</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">Theta</span> <span class="op">+</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">P_ogive</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">Theta</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="va">Theta</span> <span class="op">+</span> <span class="va">d</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Generate</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>    <span class="va">N</span> <span class="op">&lt;-</span> <span class="va">condition</span><span class="op">$</span><span class="va">sample_size</span></span>
<span>    <span class="va">nitems</span> <span class="op">&lt;-</span> <span class="va">condition</span><span class="op">$</span><span class="va">nitems</span></span>
<span>    <span class="va">nitems_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">nitems</span> <span class="op">==</span> <span class="fl">10</span>, <span class="st">'ten'</span>, <span class="st">'twenty'</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co">#extract objects from fixed_objects</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">fixed_objects</span><span class="op">[[</span><span class="va">nitems_name</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">'a'</span>, <span class="op">]</span></span>
<span>    <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">fixed_objects</span><span class="op">[[</span><span class="va">nitems_name</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">'d'</span>, <span class="op">]</span></span>
<span></span>
<span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">N</span>, <span class="va">nitems</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'item_'</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nitems</span><span class="op">)</span></span>
<span>    <span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nitems</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">P_ogive</span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="va">d</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="va">Theta</span><span class="op">)</span></span>
<span>        <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span></span>
<span>            <span class="va">dat</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="co">#data.frame works nicer with lavaan</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">Analyse.FIML</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">dat</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1L</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu">extract.mirt</span><span class="op">(</span><span class="va">mod</span>, <span class="st">'converged'</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">'mirt did not converge'</span><span class="op">)</span></span>
<span>    <span class="va">cfs</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu">coef</span><span class="op">(</span><span class="va">mod</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span>    <span class="va">FIML_as</span> <span class="op">&lt;-</span> <span class="va">cfs</span><span class="op">$</span><span class="va">items</span><span class="op">[</span>,<span class="fl">1L</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1.702</span></span>
<span>    </span>
<span>    <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>as<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">FIML_as</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ret</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">Analyse.DWLS</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">dat</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">nitems</span> <span class="op">&lt;-</span> <span class="va">condition</span><span class="op">$</span><span class="va">nitems</span></span>
<span>    <span class="va">lavmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'F =~ '</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'NA*'</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">[</span><span class="fl">1L</span><span class="op">]</span>, <span class="st">' + '</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1L</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">' + '</span><span class="op">)</span>,</span>
<span>                     <span class="st">'\nF ~~ 1*F'</span><span class="op">)</span></span>
<span>    <span class="va">lmod</span> <span class="op">&lt;-</span> <span class="fu">sem</span><span class="op">(</span><span class="va">lavmod</span>, <span class="va">dat</span>, ordered <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu">lavInspect</span><span class="op">(</span><span class="va">lmod</span>, <span class="st">'converged'</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">'lavaan did not converge'</span><span class="op">)</span></span>
<span>    <span class="va">cfs2</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu">coef</span><span class="op">(</span><span class="va">lmod</span><span class="op">)</span></span>
<span>    <span class="va">DWLS_alpha</span> <span class="op">&lt;-</span> <span class="va">cfs2</span><span class="op">[</span><span class="fl">1L</span><span class="op">:</span><span class="va">nitems</span><span class="op">]</span></span>
<span>    <span class="va">const</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">DWLS_alpha</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">DWLS_as</span> <span class="op">&lt;-</span> <span class="va">DWLS_alpha</span> <span class="op">/</span> <span class="va">const</span></span>
<span></span>
<span>    <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>as<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">DWLS_as</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ret</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">Summarise</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">results</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">nitems</span> <span class="op">&lt;-</span> <span class="va">condition</span><span class="op">$</span><span class="va">nitems</span></span>
<span>    <span class="va">nitems_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">nitems</span> <span class="op">==</span> <span class="fl">10</span>, <span class="st">'ten'</span>, <span class="st">'twenty'</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co">#extract objects from fixed_objects</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">fixed_objects</span><span class="op">[[</span><span class="va">nitems_name</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">'a'</span>, <span class="op">]</span></span>
<span>    <span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">a</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">obt_bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bias.html">bias</a></span><span class="op">(</span><span class="va">results</span>, <span class="va">pop</span><span class="op">)</span></span>
<span>    <span class="va">obt_RMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RMSE.html">RMSE</a></span><span class="op">(</span><span class="va">results</span>, <span class="va">pop</span><span class="op">)</span></span>
<span>    <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>bias<span class="op">=</span><span class="va">obt_bias</span>, RMSE<span class="op">=</span><span class="va">obt_RMSE</span><span class="op">)</span></span>
<span>    <span class="va">ret</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runSimulation.html">runSimulation</a></span><span class="op">(</span><span class="va">Design</span>, replications<span class="op">=</span><span class="fl">100</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                     generate<span class="op">=</span><span class="va">Generate</span>, </span>
<span>                     analyse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>FIML<span class="op">=</span><span class="va">Analyse.FIML</span>, DWLS<span class="op">=</span><span class="va">Analyse.DWLS</span><span class="op">)</span>, </span>
<span>                     summarise<span class="op">=</span><span class="va">Summarise</span>, filename <span class="op">=</span> <span class="st">'mirt_lavaan'</span>,</span>
<span>                     fixed_objects<span class="op">=</span><span class="va">pars</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 Ã— 86</span></span></span>
<span><span class="co">##   sample_size nitems bias.FIML.as1 bias.FIML.as2 bias.FIML.as3 bias.FIML.as4</span></span>
<span><span class="co">##         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>         250     10     0.009<span style="text-decoration: underline;">988</span>7     0.013<span style="text-decoration: underline;">457</span>     -<span style="color: #BB0000;">0.020</span><span style="color: #BB0000; text-decoration: underline;">161</span>      0.186<span style="text-decoration: underline;">16</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>         500     10    -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">136</span>      0.018<span style="text-decoration: underline;">720</span>     -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">173</span>      0.104<span style="text-decoration: underline;">24</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>        <span style="text-decoration: underline;">1</span>000     10    -<span style="color: #BB0000;">0.003</span><span style="color: #BB0000; text-decoration: underline;">947</span><span style="color: #BB0000;">3</span>    -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">477</span><span style="color: #BB0000;">8</span>    -<span style="color: #BB0000;">0.013</span><span style="color: #BB0000; text-decoration: underline;">393</span>      0.077<span style="text-decoration: underline;">890</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>         250     20     0.060<span style="text-decoration: underline;">647</span>      0.011<span style="text-decoration: underline;">787</span>      0.064<span style="text-decoration: underline;">688</span>     -<span style="color: #BB0000;">0.026</span><span style="color: #BB0000; text-decoration: underline;">314</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>         500     20     0.019<span style="text-decoration: underline;">202</span>      0.045<span style="text-decoration: underline;">376</span>      0.021<span style="text-decoration: underline;">837</span>     -<span style="color: #BB0000;">0.006</span><span style="color: #BB0000; text-decoration: underline;">358</span><span style="color: #BB0000;">7</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>        <span style="text-decoration: underline;">1</span>000     20     0.019<span style="text-decoration: underline;">976</span>      0.018<span style="text-decoration: underline;">608</span>      0.007<span style="text-decoration: underline;">981</span>7    -<span style="color: #BB0000;">0.011</span><span style="color: #BB0000; text-decoration: underline;">498</span> </span></span>
<span><span class="co">## <span style="color: #949494;"># â„¹ 80 more variables: bias.FIML.as5 &lt;dbl&gt;, bias.FIML.as6 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   bias.FIML.as7 &lt;dbl&gt;, bias.FIML.as8 &lt;dbl&gt;, bias.FIML.as9 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   bias.FIML.as10 &lt;dbl&gt;, bias.DWLS.as1 &lt;dbl&gt;, bias.DWLS.as2 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   bias.DWLS.as3 &lt;dbl&gt;, bias.DWLS.as4 &lt;dbl&gt;, bias.DWLS.as5 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   bias.DWLS.as6 &lt;dbl&gt;, bias.DWLS.as7 &lt;dbl&gt;, bias.DWLS.as8 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   bias.DWLS.as9 &lt;dbl&gt;, bias.DWLS.as10 &lt;dbl&gt;, RMSE.FIML.as1 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   RMSE.FIML.as2 &lt;dbl&gt;, RMSE.FIML.as3 &lt;dbl&gt;, RMSE.FIML.as4 &lt;dbl&gt;, â€¦</span></span></span></code></pre>
<p>In this particular formulation the <code>mirt</code> and
<code>lavaan</code> package analyses have been completely isolated into
their own respective functions, and in principle could therefore be
analyzed independently in future simulation studies. This adds a nicer
layer of potential modularity to the Analyse portion of the
<code>SimDesign</code> framework, where re-using or modifying previous
<code>SimDesign</code> code should be less painful.</p>
</div>
</div>
<div class="section level2">
<h2 id="analyseif">
<code>AnalyseIf()</code><a class="anchor" aria-label="anchor" href="#analyseif"></a>
</h2>
<p>In situations where analysis functions defined in the
<code>analyse</code> list should only be applied in certain design
conditions, users can include an <code><a href="../reference/AnalyseIf.html">AnalyseIf()</a></code> definition at
the beginning of their respective functions to ensure the analyses are
only executed when the provided logical is <code>TRUE</code>. This
logical ensures the data generation conditions are suitable for the
analysis function to be investigated; otherwise, it is skipped over in
the generate-analyse-summarise work-flow.</p>
<p>As a continuation from above, say that an investigator was also
interested in recovering the slope parameters of a factor analysis model
where the observed indicator variable were continuous as well as
discrete. The <code>Design</code> definition may therefore look like the
following.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDesign.html">createDesign</a></span><span class="op">(</span>sample_size <span class="op">=</span> <span class="va">sample_sizes</span>, </span>
<span>                       nitems <span class="op">=</span> <span class="va">nitems</span>, </span>
<span>                       indicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'discrete'</span>, <span class="st">'continuous'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Design</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 12 Ã— 3</span></span></span>
<span><span class="co">##    sample_size nitems indicators</span></span>
<span><span class="co">##          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>         250     10 discrete  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>         500     10 discrete  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>        <span style="text-decoration: underline;">1</span>000     10 discrete  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>         250     20 discrete  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>         500     20 discrete  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>        <span style="text-decoration: underline;">1</span>000     20 discrete  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>         250     10 continuous</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>         500     10 continuous</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>        <span style="text-decoration: underline;">1</span>000     10 continuous</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>         250     20 continuous</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>         500     20 continuous</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>        <span style="text-decoration: underline;">1</span>000     20 continuous</span></span></code></pre>
<p>Provided that the <code><a href="../reference/Generate.html">Generate()</a></code> step utilized this
<code>indicators</code> character vector, this would imply that the
<code>dat</code> object returned from <code><a href="../reference/Generate.html">Generate()</a></code> could
consist of discrete or continuous data. In the case of continuous
indicator variables, <code>lavaan</code> could be used as it supports
such indicator types; however, <code>mirt</code> cannot. So, to ensure
that only the analysis function pertaining to <code>lavaan</code> is
used one could include the following replacement definition that used
<code>mirt</code>, but now includes an <code><a href="../reference/AnalyseIf.html">AnalyseIf()</a></code> logical
given the <code>indicators</code> variableâ€™s state.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Analyse.FIML</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">dat</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/AnalyseIf.html">AnalyseIf</a></span><span class="op">(</span><span class="va">condition</span><span class="op">$</span><span class="va">indicators</span> <span class="op">==</span> <span class="st">'discrete'</span><span class="op">)</span></span>
<span>    <span class="co"># equivalently: </span></span>
<span>    <span class="co">#   AnalyseIf(indicators == 'discrete', condition)</span></span>
<span>    <span class="co">#   with(condition, AnalyseIf(indicators == 'discrete'))</span></span>
<span>    <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1L</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu">extract.mirt</span><span class="op">(</span><span class="va">mod</span>, <span class="st">'converged'</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">'mirt did not converge'</span><span class="op">)</span></span>
<span>    <span class="va">cfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span>    <span class="va">FIML_as</span> <span class="op">&lt;-</span> <span class="va">cfs</span><span class="op">$</span><span class="va">items</span><span class="op">[</span>,<span class="fl">1L</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1.702</span></span>
<span>    </span>
<span>    <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>as<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">FIML_as</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ret</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Using this definition the final object returned by
<code><a href="../reference/runSimulation.html">runSimulation()</a></code> will provide suitable <code>NA</code>
placeholders (where appropriate). For continuous indicators the results
will be presented as though <code>mirt</code> was never used for the
continuous indicator conditions controlled by the <code>Design</code>
object.</p>
<p>Note that a similar logic can be made for multiple
<code><a href="../reference/Generate.html">Generate()</a></code> functions, templated via
<code>SimDesign::SimFunctions(nGenerate = 2)</code>, and requiring
specific <code><a href="../reference/GenerateIf.html">GenerateIf()</a></code> tests to indicate which generation
function should be used. For those interested in this type of structure,
the following could be used to separate the discrete/continuous data
generation per <code>Design</code> row:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Generate.G1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/GenerateIf.html">GenerateIf</a></span><span class="op">(</span><span class="va">condition</span><span class="op">$</span><span class="va">indicators</span> <span class="op">==</span> <span class="st">'discrete'</span><span class="op">)</span></span>
<span>    <span class="va">...</span></span>
<span>    <span class="va">dat</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">Generate.G2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/GenerateIf.html">GenerateIf</a></span><span class="op">(</span><span class="va">condition</span><span class="op">$</span><span class="va">indicators</span> <span class="op">==</span> <span class="st">'continuous'</span><span class="op">)</span></span>
<span>    <span class="va">...</span></span>
<span>    <span class="va">dat</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runSimulation.html">runSimulation</a></span><span class="op">(</span>design<span class="op">=</span><span class="va">Design</span>, replications<span class="op">=</span><span class="fl">1000</span>,</span>
<span>                     generate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>G1<span class="op">=</span><span class="va">Generate.G1</span>, G2<span class="op">=</span><span class="va">Generate.G2</span><span class="op">)</span>, </span>
<span>                     analyse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DWLS<span class="op">=</span><span class="va">Analyse.DWLS</span>, FIML<span class="op">=</span><span class="va">Analyse.FIML</span><span class="op">)</span>, </span>
<span>                     summarise<span class="op">=</span><span class="va">Summarise</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="applying-one-analyse-function-per-condition">Applying one analyse function per-condition<a class="anchor" aria-label="anchor" href="#applying-one-analyse-function-per-condition"></a>
</h3>
<p>Interestingly, <code><a href="../reference/AnalyseIf.html">AnalyseIf()</a></code> could also be used to select
only one analysis function at a time given the components in the
<code>Design</code> object. For instance, if the <code>Design</code>
definition were constructed using</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDesign.html">createDesign</a></span><span class="op">(</span>sample_size <span class="op">=</span> <span class="va">sample_sizes</span>, </span>
<span>                       nitems <span class="op">=</span> <span class="va">nitems</span>, </span>
<span>                       method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'FIML'</span>, <span class="st">'DWLS'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Design</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 12 Ã— 3</span></span></span>
<span><span class="co">##    sample_size nitems method</span></span>
<span><span class="co">##          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>         250     10 FIML  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>         500     10 FIML  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>        <span style="text-decoration: underline;">1</span>000     10 FIML  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>         250     20 FIML  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>         500     20 FIML  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>        <span style="text-decoration: underline;">1</span>000     20 FIML  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>         250     10 DWLS  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>         500     10 DWLS  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>        <span style="text-decoration: underline;">1</span>000     10 DWLS  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>         250     20 DWLS  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>         500     20 DWLS  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>        <span style="text-decoration: underline;">1</span>000     20 DWLS</span></span></code></pre>
<p>and the analysis functions above were supplied defined as</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Analyse.FIML</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">dat</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/AnalyseIf.html">AnalyseIf</a></span><span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">'FIML'</span>, <span class="va">condition</span><span class="op">)</span></span>
<span>    <span class="co">#...</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">Analyse.DWLS</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">dat</span>, <span class="va">fixed_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/AnalyseIf.html">AnalyseIf</a></span><span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">'DWLS'</span>, <span class="va">condition</span><span class="op">)</span></span>
<span>    <span class="co"># ...</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># ...</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runSimulation.html">runSimulation</a></span><span class="op">(</span><span class="va">Design</span>, replications<span class="op">=</span><span class="fl">100</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                     generate<span class="op">=</span><span class="va">Generate</span>, </span>
<span>                     analyse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Analyse.FIML</span>, <span class="va">Analyse.DWLS</span><span class="op">)</span>, </span>
<span>                     summarise<span class="op">=</span><span class="va">Summarise</span>, filename <span class="op">=</span> <span class="st">'mirt_lavaan'</span>,</span>
<span>                     fixed_objects<span class="op">=</span><span class="va">pars</span><span class="op">)</span></span></code></pre></div>
<p>then only one analysis function will be applied at a time in the
simulation experiment. Note that in this case there is no need to append
â€˜MMLâ€™ or â€˜DWLSâ€™ to the <code>results</code> objects as this becomes
redundant with the <code>method</code> column in the <code>Design</code>
object, and so the <code>analyse</code> list input is specified as an
unnamed list (cf.Â earlier when the input was named, which appended
<code>MML.</code> and <code>DWLS.</code> to the <code>results</code>
output in <code><a href="../reference/Summarise.html">Summarise()</a></code>).</p>
<p>Users may find this a more natural setup than having to merge all
analysis information into a single <code><a href="../reference/Analyse.html">Analyse()</a></code> definition.
The downside, however, is that the analysis function will be applied to
different generated datasets, which while theoretically unbiased could
have ramifications should the analysis functions throw errors at
different rates (even when explicitly supplying a <code>seed</code>
vector input to <code><a href="../reference/runSimulation.html">runSimulation()</a></code>).</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
